import{r as n,a as Me,R as qe}from"./vendor-wGySg1uH.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))t(d);new MutationObserver(d=>{for(const c of d)if(c.type==="childList")for(const o of c.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function r(d){const c={};return d.integrity&&(c.integrity=d.integrity),d.referrerPolicy&&(c.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?c.credentials="include":d.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function t(d){if(d.ep)return;d.ep=!0;const c=r(d);fetch(d.href,c)}})();var Te={exports:{}},he={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ke=n,Ae=Symbol.for("react.element"),Be=Symbol.for("react.fragment"),_e=Object.prototype.hasOwnProperty,Je=Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ve={key:!0,ref:!0,__self:!0,__source:!0};function $e(s,a,r){var t,d={},c=null,o=null;r!==void 0&&(c=""+r),a.key!==void 0&&(c=""+a.key),a.ref!==void 0&&(o=a.ref);for(t in a)_e.call(a,t)&&!Ve.hasOwnProperty(t)&&(d[t]=a[t]);if(s&&s.defaultProps)for(t in a=s.defaultProps,a)d[t]===void 0&&(d[t]=a[t]);return{$$typeof:Ae,type:s,key:c,ref:o,props:d,_owner:Je.current}}he.Fragment=Be;he.jsx=$e;he.jsxs=$e;Te.exports=he;var e=Te.exports,Ie={},Pe=Me;Ie.createRoot=Pe.createRoot,Ie.hydrateRoot=Pe.hydrateRoot;const Ue="/api";let ue=null;function me(s){ue=s,s?localStorage.setItem("sessionId",s):localStorage.removeItem("sessionId")}function Oe(){return ue||(ue=localStorage.getItem("sessionId")),ue}async function P(s,a={}){const r=Oe(),t={"Content-Type":"application/json",...a.headers||{}};r&&(t.Authorization=`Bearer ${r}`);try{const d=await fetch(`${Ue}${s}`,{...a,headers:t,credentials:"include"});let c;try{c=await d.json()}catch{return{success:!1,error:`æœåŠ¡å™¨å“åº”é”™è¯¯ (${d.status})`}}return d.ok?c:{success:!1,error:c.error||`è¯·æ±‚å¤±è´¥ (${d.status})`}}catch(d){const c=d instanceof Error?d.message:"ç½‘ç»œé”™è¯¯";return console.error("APIè¯·æ±‚å¤±è´¥:",c),{success:!1,error:c.includes("fetch")?"ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ":c}}}async function Re(s){var r,t,d,c;const a=await P("/auth/login",{method:"POST",body:JSON.stringify({code:s})});return a.success&&((r=a.data)!=null&&r.sessionId)&&me(a.data.sessionId),{success:a.success,userType:((t=a.data)==null?void 0:t.userType)||"player",factionId:(d=a.data)==null?void 0:d.factionId,sessionId:(c=a.data)==null?void 0:c.sessionId,error:a.error}}async function ze(){await P("/auth/logout",{method:"POST"}),me(null)}async function He(){return P("/auth/me")}async function Ge(){const s=await P("/factions/me");return s.success&&s.data?{success:!0,data:s.data}:{success:!1,error:s.error}}async function Ye(s){const a=await P(`/factions/${s}`);return a.success&&a.data?{success:!0,data:a.data}:{success:!1,error:a.error}}async function Qe(s){const a=s?`/recruitment/info?factionId=${s}`:"/recruitment/info";return P(a)}async function We(s,a){return P("/recruitment/recruit",{method:"POST",body:JSON.stringify({count:s,factionId:a})})}async function Xe(s){const a=s?`/legions/commanders?factionId=${s}`:"/legions/commanders";return P(a)}async function Ze(s){const a=s?`/legions/territories?factionId=${s}`:"/legions/territories";return P(a)}async function es(s,a){return P("/legions/check-commander",{method:"POST",body:JSON.stringify({commanderId:s,excludeLegionId:a})})}async function ss(s){return P("/legions",{method:"POST",body:JSON.stringify(s)})}async function as(s,a){return P(`/legions/${s}`,{method:"DELETE",body:JSON.stringify({factionId:a})})}async function ns(s,a,r){return P(`/legions/${s}/soldiers`,{method:"PATCH",body:JSON.stringify({count:a,factionId:r})})}async function ts(s,a,r){return P(`/legions/${s}/equipment`,{method:"PATCH",body:JSON.stringify({...a,factionId:r})})}async function ls(s){const a=s?`/investment/status?factionId=${s}`:"/investment/status";return P(a)}async function is(s){const a=s?`/investment/samurais?factionId=${s}`:"/investment/samurais";return P(a)}async function rs(s,a,r,t){return P("/investment/preview",{method:"POST",body:JSON.stringify({type:s,samuraiId:a,amount:r,factionId:t})})}async function cs(s,a,r,t){return P("/investment/execute",{method:"POST",body:JSON.stringify({type:s,samuraiId:a,amount:r,factionId:t})})}async function os(s){const a=new URLSearchParams;s&&(s.provinceName&&a.set("provinceName",s.provinceName),s.districtName&&a.set("districtName",s.districtName),s.factionId!==void 0&&a.set("factionId",s.factionId),s.hasSpecialProduct!==void 0&&a.set("hasSpecialProduct",String(s.hasSpecialProduct)),s.minKokudaka!==void 0&&a.set("minKokudaka",String(s.minKokudaka)),s.maxKokudaka!==void 0&&a.set("maxKokudaka",String(s.maxKokudaka)));const r=a.toString(),t=`/admin/territories${r?`?${r}`:""}`;return P(t)}async function ds(s){return P("/admin/territories",{method:"POST",body:JSON.stringify(s)})}async function us(s,a){return P(`/admin/territories/${s}`,{method:"PUT",body:JSON.stringify(a)})}async function ms(s){return P(`/admin/territories/${s}`,{method:"DELETE"})}async function De(){return P("/admin/factions")}async function hs(){return P("/admin/factions/full")}async function xs(s){return P("/admin/factions",{method:"POST",body:JSON.stringify(s)})}async function Fe(s,a){return P(`/admin/factions/${s}`,{method:"PUT",body:JSON.stringify(a)})}async function js(s,a){return P(`/admin/factions/${s}/code`,{method:"PUT",body:JSON.stringify({code:a})})}async function ps(s){return P(`/admin/factions/${s}`,{method:"DELETE"})}async function fs(){return P("/admin/legions")}async function vs(s,a){return P(`/admin/legions/${s}`,{method:"PUT",body:JSON.stringify(a)})}async function Ns(s){return P(`/admin/legions/${s}`,{method:"DELETE"})}async function gs(){return P("/admin/special-products")}async function bs(s){return P("/admin/special-products",{method:"POST",body:JSON.stringify(s)})}async function ys(s,a){return P(`/admin/special-products/${encodeURIComponent(s)}`,{method:"PUT",body:JSON.stringify(a)})}async function Cs(s){return P(`/admin/special-products/${encodeURIComponent(s)}`,{method:"DELETE"})}async function Le(){return P("/admin/options/factions")}async function ks(){return P("/game/status/summary")}async function Ss(){return P("/game/advance-year",{method:"POST"})}async function ws(){return P("/game/lock",{method:"POST"})}async function Is(){return P("/game/unlock",{method:"POST"})}async function Ls(s){const a=new URLSearchParams;s&&(s.year!==void 0&&a.set("year",String(s.year)),s.factionId&&a.set("factionId",s.factionId),s.shouldCalculate!==void 0&&a.set("shouldCalculate",String(s.shouldCalculate)));const r=a.toString(),t=`/game/accounting-logs${r?`?${r}`:""}`;return P(t)}async function Ps(s){return P("/game/accounting-logs",{method:"POST",body:JSON.stringify(s)})}async function Es(s){return P(`/game/accounting-logs/${s}`,{method:"DELETE"})}async function Ts(s){const a=`/game/operations/rollbackable?limit=${s}`;return P(a)}async function $s(s){return P(`/game/rollback/${s}`,{method:"POST"})}async function Os(s){return P(`/import/template/${s}`)}async function Rs(s,a){return P(`/import/preview/${s}`,{method:"POST",body:JSON.stringify({text:a})})}async function Ds(s,a,r=!0){return P(`/import/${s}`,{method:"POST",body:JSON.stringify({text:a,overwrite:r})})}async function Fs(s){return P("/error-reports/manual",{method:"POST",body:JSON.stringify({errorMessage:s})})}async function Ms(s){const a=new URLSearchParams;s&&(s.factionId&&a.set("factionId",s.factionId),s.startTime&&a.set("startTime",s.startTime),s.endTime&&a.set("endTime",s.endTime),s.resolved!==void 0&&a.set("resolved",String(s.resolved)));const r=a.toString(),t=`/error-reports${r?`?${r}`:""}`;return P(t)}async function qs(s){return P(`/error-reports/${s}/resolve`,{method:"PUT"})}async function Ks(s){return P(`/error-reports/${s}`,{method:"DELETE"})}async function As(s){const a=s?`/disband-soldiers/info?factionId=${s}`:"/disband-soldiers/info";return P(a)}async function Bs(s,a){return P("/disband-soldiers",{method:"POST",body:JSON.stringify({count:s,factionId:a})})}async function _s(s){return P(`/admin/factions/${s}/samurais`)}async function Js(s){return P("/admin/samurais",{method:"POST",body:JSON.stringify(s)})}async function Vs(s,a){return P(`/admin/samurais/${s}`,{method:"PUT",body:JSON.stringify(a)})}async function Us(s){return P(`/admin/samurais/${s}`,{method:"DELETE"})}const Y={rifles:10,horses:12,cannons:450};async function zs(s,a,r,t){return P("/equipment/purchase",{method:"POST",body:JSON.stringify({rifles:s,horses:a,cannons:r,factionId:t})})}async function Hs(s){const a=s?`/tax-rate/info?factionId=${s}`:"/tax-rate/info";return P(a)}async function Gs(s,a){return P("/tax-rate/change",{method:"POST",body:JSON.stringify({taxRate:s,factionId:a})})}function Ys(){const s=new URLSearchParams(window.location.search);return{code:s.get("code")||void 0,view:s.get("view")||void 0,factionId:s.get("faction")||void 0}}function Qs(){return window.location.origin+window.location.pathname}function we(){const s=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,s)}async function Ws(s){try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(s),!0;const a=document.createElement("textarea");a.value=s,a.style.position="fixed",a.style.left="-9999px",document.body.appendChild(a),a.select();const r=document.execCommand("copy");return document.body.removeChild(a),r}catch{return!1}}function Xs({onLoginSuccess:s,initialError:a}){const[r,t]=n.useState(""),[d,c]=n.useState(a||null),[o,f]=n.useState(!1),[l,k]=n.useState(!1);n.useEffect(()=>{a&&c(a)},[a]);const m=async y=>{if(y.preventDefault(),!r.trim()){c("è¯·è¾“å…¥ç™»å½•ä»£ç ");return}f(!0),c(null);try{const j=await Re(r.trim());if(j.success){console.log("Login result:",j);const g={type:j.userType,factionId:j.factionId};console.log("Created user:",g),s(g)}else c(j.error||"ç™»å½•å¤±è´¥")}catch{c("ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•")}finally{f(!1)}},h=y=>{y.key==="Enter"&&m(y)},v=async()=>{const y=Qs();await Ws(y)&&(k(!0),setTimeout(()=>k(!1),2e3))};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsx("h1",{className:"login-title",children:"ä¸‹å…‹ä¸Šå°åŠ©æ‰‹"}),e.jsx("p",{className:"login-subtitle",children:"æ–‡å­—æ¸¸æˆè¾…åŠ©ç³»ç»Ÿ"}),e.jsxs("form",{onSubmit:m,className:"login-form",children:[e.jsxs("div",{className:"input-group",children:[e.jsx("label",{htmlFor:"code",className:"input-label",children:"ç™»å½•ä»£ç "}),e.jsx("input",{id:"code",type:"text",value:r,onChange:y=>t(y.target.value),onKeyDown:h,placeholder:"è¯·è¾“å…¥ä»£ç ",className:`login-input ${d?"input-error":""}`,disabled:o,autoFocus:!0})]}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsx("button",{type:"submit",className:"login-button",disabled:o,children:o?"ç™»å½•ä¸­...":"ç¡®è®¤"})]}),e.jsxs("div",{className:"login-hint",children:[e.jsx("p",{children:"ç®¡ç†å‘˜è¯·è¾“å…¥ç®¡ç†å‘˜ä»£ç "}),e.jsx("p",{children:"ç©å®¶è¯·è¾“å…¥åŠ¿åŠ›ä¸“å±ä»£ç "})]}),e.jsxs("div",{className:"share-section",children:[e.jsx("button",{type:"button",className:"share-button",onClick:v,children:l?"å·²å¤åˆ¶!":"å¤åˆ¶åˆ†äº«é“¾æ¥"}),e.jsx("p",{className:"share-hint",children:"åˆ†äº«æ­¤é“¾æ¥ç»™å…¶ä»–ç©å®¶"})]})]})})}function se({columns:s,data:a,maxRows:r=10,rowKey:t,onRowClick:d,emptyText:c="æš‚æ— æ•°æ®",className:o=""}){const f=a.length>r;return e.jsxs("div",{className:`data-table-container ${o}`,children:[e.jsx("div",{className:"data-table-header",children:e.jsx("table",{className:"data-table",children:e.jsx("thead",{children:e.jsx("tr",{children:s.map(l=>e.jsx("th",{style:{width:l.width},children:l.title},l.key))})})})}),e.jsx("div",{className:`data-table-body ${f?"scrollable":""}`,style:{maxHeight:f?`${r*44}px`:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("colgroup",{children:s.map(l=>e.jsx("col",{style:{width:l.width}},l.key))}),e.jsx("tbody",{children:a.length===0?e.jsx("tr",{className:"empty-row",children:e.jsx("td",{colSpan:s.length,children:c})}):a.map((l,k)=>e.jsx("tr",{onClick:()=>d==null?void 0:d(l),className:d?"clickable":"",children:s.map(m=>e.jsx("td",{children:m.render?m.render(l,k):String(l[m.key]??"")},m.key))},t(l)))})]})})]})}function Zs({territories:s,legions:a}){const r=new Map(a.map(d=>[d.id,d.name])),t=[{key:"districtName",title:"éƒ¡å",width:"12%"},{key:"provinceName",title:"ä»¤åˆ¶å›½",width:"12%"},{key:"baseKokudaka",title:"çŸ³é«˜",width:"12%",render:d=>`${d.baseKokudaka.toLocaleString("zh-CN")}çŸ³`},{key:"castle",title:"åŸæ± ",width:"18%",render:d=>e.jsxs("span",{className:"castle-info",children:[d.castleName,e.jsxs("span",{className:"castle-level",children:["Lv.",d.castleLevel]})]})},{key:"specialProducts",title:"ç‰¹äº§",width:"26%",render:d=>{const c=[d.specialProduct1,d.specialProduct2,d.specialProduct3].filter(Boolean);return c.length>0?e.jsx("span",{className:"special-products",children:c.map((o,f)=>e.jsx("span",{className:"product-tag",children:o},f))}):e.jsx("span",{className:"no-product",children:"-"})}},{key:"garrison",title:"é©»æ‰å†›å›¢",width:"20%",render:d=>{const c=d.garrisonLegionId?r.get(d.garrisonLegionId):null;return c?e.jsx("span",{className:"garrison-name",children:c}):e.jsx("span",{className:"no-garrison",children:"-"})}}];return e.jsx("div",{className:"territory-list",children:e.jsx(se,{columns:t,data:s,rowKey:d=>d.id,emptyText:"æš‚æ— é¢†åœ°æ•°æ®"})})}function ea({samurais:s}){const a=[{key:"name",title:"å§“å",width:"20%"},{key:"type",title:"ç±»å‹",width:"15%",render:r=>e.jsx("span",{className:`samurai-type ${r.type}`,children:r.type==="warrior"?"çŒ›å°†":"æ™ºå°†"})},{key:"martialValue",title:"æ­¦åŠŸ",width:"15%",render:r=>e.jsx("span",{className:"stat-value martial",children:r.martialValue})},{key:"civilValue",title:"æ–‡æ²»",width:"15%",render:r=>e.jsx("span",{className:"stat-value civil",children:r.civilValue})},{key:"status",title:"çŠ¶æ€",width:"15%",render:r=>e.jsx("span",{className:`samurai-status ${r.isIdle?"idle":"busy"}`,children:r.isIdle?"å¾…å‘½":"ä»»åŠ¡ä¸­"})},{key:"actionPoints",title:"è¡ŒåŠ¨åŠ›",width:"20%",render:r=>{const t=r.actionPoints>=2?"ap-full":r.actionPoints===1?"ap-half":"ap-empty";return e.jsxs("span",{className:`action-points ${t}`,children:[e.jsx("span",{className:"ap-current",children:r.actionPoints}),e.jsx("span",{className:"ap-separator",children:"/"}),e.jsx("span",{className:"ap-max",children:"2"})]})}}];return e.jsx("div",{className:"samurai-list",children:e.jsx(se,{columns:a,data:s,rowKey:r=>r.id,emptyText:"æš‚æ— æ­¦å£«æ•°æ®"})})}const sa={alliance:{label:"åŒç›Ÿ",className:"alliance"},hostile:{label:"æ•Œå¯¹",className:"hostile"},neutral:{label:"ä¸­ç«‹",className:"neutral"},vassal:{label:"ä»å±",className:"vassal"},suzerain:{label:"å®—ä¸»",className:"suzerain"},truce:{label:"åœæˆ˜",className:"truce"},war:{label:"äº¤æˆ˜",className:"war"}};function aa(s){return sa[s]||{label:s,className:"default"}}function na({diplomacy:s}){const a=[{key:"targetFactionName",title:"ç›®æ ‡åŠ¿åŠ›",width:"50%",render:r=>e.jsx("span",{className:"faction-name",children:r.targetFactionName})},{key:"relation",title:"å½“å‰å…³ç³»",width:"50%",render:r=>{const t=aa(r.relation);return e.jsx("span",{className:`relation-badge ${t.className}`,children:t.label})}}];return e.jsx("div",{className:"diplomacy-list",children:e.jsx(se,{columns:a,data:s,rowKey:r=>r.targetFactionId,emptyText:"æš‚æ— å¤–äº¤å…³ç³»"})})}function ta({legions:s,onDisband:a,onEditSoldiers:r,onEditEquipment:t}){const[d,c]=n.useState(null),o=l=>{c(d===l.id?null:l.id)},f=[{key:"name",title:"å†›å›¢åç§°",width:"15%",render:l=>e.jsx("span",{className:"legion-name",children:l.name})},{key:"commanderName",title:"å°†é¢†",width:"12%"},{key:"soldierCount",title:"äººæ•°",width:"10%",render:l=>e.jsx("span",{className:"soldier-count",children:l.soldierCount.toLocaleString("zh-CN")})},{key:"rifles",title:"é“ç‚®",width:"10%",render:l=>e.jsx("span",{className:"equipment-count",children:l.rifles})},{key:"horses",title:"æˆ˜é©¬",width:"10%",render:l=>e.jsx("span",{className:"equipment-count",children:l.horses})},{key:"cannons",title:"å¤§ç­’",width:"10%",render:l=>e.jsx("span",{className:"equipment-count",children:l.cannons})},{key:"locationName",title:"ä½ç½®",width:"15%"},{key:"actions",title:"æ“ä½œ",width:"18%",render:l=>e.jsx("span",{className:`expand-indicator ${d===l.id?"expanded":""}`,children:d===l.id?"æ”¶èµ· â–²":"ç®¡ç† â–¼"})}];return e.jsxs("div",{className:"legion-list",children:[e.jsx(se,{columns:f,data:s,rowKey:l=>l.id,onRowClick:o,emptyText:"æš‚æ— å†›å›¢æ•°æ®"}),d&&e.jsx(la,{legion:s.find(l=>l.id===d),onDisband:a,onEditSoldiers:r,onEditEquipment:t,onClose:()=>c(null)})]})}function la({legion:s,onDisband:a,onEditSoldiers:r,onEditEquipment:t,onClose:d}){const c=()=>{a&&a(s)},o=()=>{r&&r(s)},f=()=>{t&&t(s)};return e.jsxs("div",{className:"legion-management-menu",children:[e.jsxs("div",{className:"menu-header",children:[e.jsxs("span",{className:"menu-title",children:["ç®¡ç†: ",s.name]}),e.jsx("button",{className:"menu-close",onClick:d,children:"Ã—"})]}),e.jsxs("div",{className:"menu-actions",children:[e.jsx("button",{className:"action-btn edit-soldiers",onClick:o,disabled:!r,children:"ç¼–è¾‘äººæ•°"}),e.jsx("button",{className:"action-btn edit-equipment",onClick:f,disabled:!t,children:"ç¼–è¾‘è£…å¤‡"}),e.jsx("button",{className:"action-btn disband",onClick:c,disabled:!a,children:"è§£æ•£å†›å›¢"})]})]})}function A(s,a,r){return s<a?a:s>r?r:s}function ia({isOpen:s,maxValue:a,currentIdleSoldiers:r,onConfirm:t,onCancel:d}){const[c,o]=n.useState(0),[f,l]=n.useState("0");n.useEffect(()=>{s&&(o(0),l("0"))},[s]);const k=n.useCallback(y=>{const j=A(parseInt(y.target.value,10)||0,0,a);o(j),l(j.toString())},[a]),m=n.useCallback(y=>{const j=y.target.value;l(j);const g=parseInt(j,10);if(!isNaN(g)){const C=A(g,0,a);o(C)}},[a]),h=n.useCallback(()=>{const y=parseInt(f,10);isNaN(y)||y<0?(o(0),l("0")):y>a?(o(a),l(a.toString())):(o(y),l(y.toString()))},[f,a]),v=n.useCallback(()=>{c>0&&t(c)},[c,t]);return s?e.jsx("div",{className:"recruit-dialog-overlay",onClick:d,children:e.jsxs("div",{className:"recruit-dialog",onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:"recruit-dialog-header",children:[e.jsx("h3",{children:"æ‹›å‹Ÿå£«å…µ"}),e.jsx("button",{className:"close-btn",onClick:d,children:"Ã—"})]}),e.jsxs("div",{className:"recruit-dialog-content",children:[e.jsxs("div",{className:"recruit-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"label",children:"å½“å‰é—²ç½®å£«å…µ:"}),e.jsxs("span",{className:"value",children:[r.toLocaleString("zh-CN")," äºº"]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"label",children:"å¯æ‹›å‹Ÿä¸Šé™:"}),e.jsxs("span",{className:"value",children:[a.toLocaleString("zh-CN")," äºº"]})]})]}),e.jsxs("div",{className:"recruit-input-group",children:[e.jsx("label",{htmlFor:"recruit-count",children:"æ‹›å‹Ÿæ•°é‡:"}),e.jsx("input",{type:"range",id:"recruit-slider",className:"recruit-slider",min:0,max:a,value:c,onChange:k,disabled:a===0}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",id:"recruit-count",className:"recruit-number-input",min:0,max:a,value:f,onChange:m,onBlur:h,disabled:a===0}),e.jsx("span",{className:"unit",children:"äºº"})]})]}),a===0&&e.jsx("div",{className:"recruit-warning",children:"å½“å‰æ— æ³•æ‹›å‹Ÿæ›´å¤šå£«å…µï¼Œå·²è¾¾åˆ°æ‹›å‹Ÿä¸Šé™"}),e.jsxs("div",{className:"recruit-preview",children:[e.jsx("span",{children:"æ‹›å‹Ÿåé—²ç½®å£«å…µ: "}),e.jsxs("span",{className:"preview-value",children:[(r+c).toLocaleString("zh-CN")," äºº"]})]})]}),e.jsxs("div",{className:"recruit-dialog-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:d,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:v,disabled:c===0||a===0,children:"ç¡®è®¤æ‹›å‹Ÿ"})]})]})}):null}function ra({isOpen:s,maxValue:a,currentIdleSoldiers:r,treasury:t,costPerSoldier:d,onConfirm:c,onCancel:o}){const[f,l]=n.useState(0);if(n.useEffect(()=>{s&&l(0)},[s]),!s)return null;const k=v=>{l(Number(v.target.value))},m=v=>{const y=Math.max(0,Math.min(a,Number(v.target.value)||0));l(y)},h=f*d;return e.jsx("div",{className:"dialog-overlay",onClick:o,children:e.jsxs("div",{className:"dialog-content",onClick:v=>v.stopPropagation(),children:[e.jsx("h3",{children:"è§£æ•£å£«å…µ"}),e.jsxs("div",{className:"dialog-info",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{children:"å½“å‰é—²ç½®å£«å…µï¼š"}),e.jsxs("span",{children:[r.toLocaleString(),"äºº"]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{children:"å½“å‰é‡‘åº“ï¼š"}),e.jsxs("span",{children:[t.toLocaleString(),"çŸ³"]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{children:"è§£æ•£è´¹ç”¨ï¼š"}),e.jsxs("span",{children:[d,"çŸ³/äºº"]})]})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{children:["è§£æ•£æ•°é‡ï¼š",f.toLocaleString(),"äºº"]}),e.jsx("input",{type:"range",min:0,max:a,value:f,onChange:k}),e.jsx("input",{type:"number",min:0,max:a,value:f,onChange:m})]}),e.jsxs("div",{className:"cost-preview",children:[e.jsx("span",{children:"æ€»è´¹ç”¨ï¼š"}),e.jsxs("span",{className:"cost-value",children:[h.toLocaleString(),"çŸ³"]})]}),e.jsxs("div",{className:"dialog-actions",children:[e.jsx("button",{className:"cancel-btn",onClick:o,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:()=>c(f),disabled:f<=0,children:"ç¡®è®¤è§£æ•£"})]})]})})}function ca({isOpen:s,treasury:a,onConfirm:r,onCancel:t}){const[d,c]=n.useState(0),[o,f]=n.useState(0),[l,k]=n.useState(0),m=d*Y.rifles+o*Y.horses+l*Y.cannons,h=Math.floor(a/Y.rifles),v=Math.floor(a/Y.horses),y=Math.floor(a/Y.cannons),j=a-m,g=m<=a;if(n.useEffect(()=>{s&&(c(0),f(0),k(0))},[s]),!s)return null;const C=()=>{m>0&&g&&r(d,o,l)},b=I=>{const N=Math.max(0,Math.min(I,h));c(N)},i=I=>{const N=Math.max(0,Math.min(I,v));f(N)},E=I=>{const N=Math.max(0,Math.min(I,y));k(N)};return e.jsx("div",{className:"modal-overlay",onClick:t,children:e.jsxs("div",{className:"modal-content purchase-dialog",onClick:I=>I.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"è´­ä¹°è£…å¤‡"}),e.jsx("button",{className:"modal-close",onClick:t,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"treasury-info",children:[e.jsx("span",{children:"å½“å‰é‡‘åº“ï¼š"}),e.jsxs("span",{className:"treasury-value",children:[a.toLocaleString(),"çŸ³"]})]}),e.jsxs("div",{className:"equipment-row",children:[e.jsxs("div",{className:"equipment-info",children:[e.jsx("span",{className:"equipment-name",children:"é“ç‚®"}),e.jsxs("span",{className:"equipment-price",children:[Y.rifles,"çŸ³/æŒº"]})]}),e.jsxs("div",{className:"equipment-input",children:[e.jsx("input",{type:"range",min:"0",max:h,value:d,onChange:I=>b(Number(I.target.value))}),e.jsx("input",{type:"number",min:"0",max:h,value:d,onChange:I=>b(Number(I.target.value))}),e.jsxs("span",{className:"equipment-subtotal",children:["= ",(d*Y.rifles).toLocaleString(),"çŸ³"]})]})]}),e.jsxs("div",{className:"equipment-row",children:[e.jsxs("div",{className:"equipment-info",children:[e.jsx("span",{className:"equipment-name",children:"æˆ˜é©¬"}),e.jsxs("span",{className:"equipment-price",children:[Y.horses,"çŸ³/åŒ¹"]})]}),e.jsxs("div",{className:"equipment-input",children:[e.jsx("input",{type:"range",min:"0",max:v,value:o,onChange:I=>i(Number(I.target.value))}),e.jsx("input",{type:"number",min:"0",max:v,value:o,onChange:I=>i(Number(I.target.value))}),e.jsxs("span",{className:"equipment-subtotal",children:["= ",(o*Y.horses).toLocaleString(),"çŸ³"]})]})]}),e.jsxs("div",{className:"equipment-row",children:[e.jsxs("div",{className:"equipment-info",children:[e.jsx("span",{className:"equipment-name",children:"å¤§ç­’"}),e.jsxs("span",{className:"equipment-price",children:[Y.cannons,"çŸ³/é—¨"]})]}),e.jsxs("div",{className:"equipment-input",children:[e.jsx("input",{type:"range",min:"0",max:y,value:l,onChange:I=>E(Number(I.target.value))}),e.jsx("input",{type:"number",min:"0",max:y,value:l,onChange:I=>E(Number(I.target.value))}),e.jsxs("span",{className:"equipment-subtotal",children:["= ",(l*Y.cannons).toLocaleString(),"çŸ³"]})]})]}),e.jsxs("div",{className:"total-section",children:[e.jsxs("div",{className:"total-row",children:[e.jsx("span",{children:"æ€»ä»·ï¼š"}),e.jsxs("span",{className:`total-value ${g?"":"over-budget"}`,children:[m.toLocaleString(),"çŸ³"]})]}),e.jsxs("div",{className:"remaining-row",children:[e.jsx("span",{children:"è´­ä¹°åå‰©ä½™ï¼š"}),e.jsxs("span",{className:`remaining-value ${j<0?"negative":""}`,children:[j.toLocaleString(),"çŸ³"]})]})]}),!g&&e.jsx("div",{className:"error-message",children:"é‡‘åº“ä¸è¶³ï¼"})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:t,children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:C,disabled:m===0||!g,children:"ç¡®è®¤è´­ä¹°"})]})]})})}function oa({isOpen:s,commanders:a,territories:r,maxSoldiers:t,maxRifles:d,maxHorses:c,maxCannons:o,onConfirm:f,onCancel:l,onCheckConflict:k}){var re;const[m,h]=n.useState(""),[v,y]=n.useState(""),[j,g]=n.useState(1),[C,b]=n.useState("1"),[i,E]=n.useState(0),[I,N]=n.useState("0"),[D,q]=n.useState(0),[u,p]=n.useState("0"),[S,V]=n.useState(0),[_,U]=n.useState("0"),[J,G]=n.useState(""),[T,F]=n.useState({}),[B,H]=n.useState({}),[R,O]=n.useState(null),[ne,Z]=n.useState(!1);n.useEffect(()=>{s&&(h(""),y(""),g(1),b("1"),E(0),N("0"),q(0),p("0"),V(0),U("0"),G(""),F({}),H({}),O(null),Z(!1))},[s]);const Q=n.useCallback(w=>{if(!w.trim())return"å†›å›¢åç§°ä¸èƒ½ä¸ºç©º";if(!/^[\u4e00-\u9fa5]{1,8}$/.test(w.trim()))return"å†›å›¢åç§°å¿…é¡»ä¸º1-8ä¸ªç®€ä½“ä¸­æ–‡å­—ç¬¦"},[]),ie=n.useCallback(w=>{const $=w.target.value;h($),B.name&&F(W=>({...W,name:Q($)}))},[B.name,Q]),x=n.useCallback(()=>{H(w=>({...w,name:!0})),F(w=>({...w,name:Q(m)}))},[m,Q]),K=n.useCallback(async w=>{const $=w.target.value;if(y($),H(ce=>({...ce,commanderId:!0})),!$){F(ce=>({...ce,commanderId:"è¯·é€‰æ‹©å°†é¢†"})),O(null);return}F(ce=>({...ce,commanderId:void 0}));const W=await k($);W.hasConflict&&W.conflictLegion?O(W.conflictLegion):O(null)},[k]),xe=n.useCallback(w=>{const $=A(parseInt(w.target.value,10)||1,1,t);g($),b($.toString())},[t]),je=n.useCallback(w=>{b(w.target.value);const $=parseInt(w.target.value,10);isNaN($)||g(A($,1,t))},[t]),pe=n.useCallback(()=>{const w=parseInt(C,10),$=A(isNaN(w)?1:w,1,t);g($),b($.toString())},[C,t]),fe=n.useCallback(w=>{const $=A(parseInt(w.target.value,10)||0,0,d);E($),N($.toString())},[d]),ve=n.useCallback(w=>{N(w.target.value);const $=parseInt(w.target.value,10);isNaN($)||E(A($,0,d))},[d]),Ne=n.useCallback(()=>{const w=parseInt(I,10),$=A(isNaN(w)?0:w,0,d);E($),N($.toString())},[I,d]),ge=n.useCallback(w=>{const $=A(parseInt(w.target.value,10)||0,0,c);q($),p($.toString())},[c]),be=n.useCallback(w=>{p(w.target.value);const $=parseInt(w.target.value,10);isNaN($)||q(A($,0,c))},[c]),ye=n.useCallback(()=>{const w=parseInt(u,10),$=A(isNaN(w)?0:w,0,c);q($),p($.toString())},[u,c]),Ce=n.useCallback(w=>{const $=A(parseInt(w.target.value,10)||0,0,o);V($),U($.toString())},[o]),ke=n.useCallback(w=>{U(w.target.value);const $=parseInt(w.target.value,10);isNaN($)||V(A($,0,o))},[o]),oe=n.useCallback(()=>{const w=parseInt(_,10),$=A(isNaN(w)?0:w,0,o);V($),U($.toString())},[_,o]),Se=n.useCallback(w=>{const $=w.target.value;G($),H(W=>({...W,locationId:!0})),F($?W=>({...W,locationId:void 0}):W=>({...W,locationId:"è¯·é€‰æ‹©åˆ›å»ºä½ç½®"}))},[]),de=n.useCallback(()=>{const w={},$=Q(m);return $&&(w.name=$),v||(w.commanderId="è¯·é€‰æ‹©å°†é¢†"),j<=0&&(w.soldierCount="å†›å›¢äººæ•°å¿…é¡»å¤§äº0"),J||(w.locationId="è¯·é€‰æ‹©åˆ›å»ºä½ç½®"),F(w),H({name:!0,commanderId:!0,soldierCount:!0,locationId:!0}),Object.keys(w).length===0},[m,v,j,J,Q]),L=n.useCallback(()=>{if(de()){if(R){Z(!0);return}f({name:m.trim(),commanderId:v,soldierCount:j,rifles:i,horses:D,cannons:S,locationId:J})}},[de,R,m,v,j,i,D,S,J,f]),M=n.useCallback(()=>{Z(!1),f({name:m.trim(),commanderId:v,soldierCount:j,rifles:i,horses:D,cannons:S,locationId:J,forceReassign:!0})},[m,v,j,i,D,S,J,f]),z=n.useCallback(()=>{Z(!1)},[]);return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"create-legion-overlay",onClick:l,children:e.jsxs("div",{className:"create-legion-dialog",onClick:w=>w.stopPropagation(),children:[e.jsxs("div",{className:"create-legion-header",children:[e.jsx("h3",{children:"å»ºç«‹å†›å›¢"}),e.jsx("button",{className:"close-btn",onClick:l,children:"Ã—"})]}),e.jsxs("div",{className:"create-legion-content",children:[e.jsxs("div",{className:`form-group ${T.name&&B.name?"has-error":""}`,children:[e.jsx("label",{htmlFor:"legion-name",children:"å†›å›¢åç§° *"}),e.jsx("input",{type:"text",id:"legion-name",value:m,onChange:ie,onBlur:x,placeholder:"è¯·è¾“å…¥1-8ä¸ªç®€ä½“ä¸­æ–‡å­—ç¬¦",maxLength:8,className:T.name&&B.name?"error-input":""}),T.name&&B.name&&e.jsx("span",{className:"error-message",children:T.name})]}),e.jsxs("div",{className:`form-group ${T.commanderId&&B.commanderId?"has-error":""}`,children:[e.jsx("label",{htmlFor:"commander",children:"å°†é¢† *"}),e.jsxs("select",{id:"commander",value:v,onChange:K,className:T.commanderId&&B.commanderId?"error-input":"",children:[e.jsx("option",{value:"",children:"è¯·é€‰æ‹©å°†é¢†"}),a.map(w=>e.jsxs("option",{value:w.id,children:[w.name," (",w.type==="warrior"?"çŒ›å°†":"æ™ºå°†",") - æ­¦åŠŸ:",w.martialValue," æ–‡æ²»:",w.civilValue]},w.id))]}),T.commanderId&&B.commanderId&&e.jsx("span",{className:"error-message",children:T.commanderId}),R&&e.jsxs("span",{className:"warning-message",children:["âš ï¸ è¯¥å°†é¢†å·²æ˜¯å†›å›¢ã€Œ",R.name,"ã€çš„æŒ‡æŒ¥å®˜"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["å†›å›¢äººæ•° * (åº“å­˜: ",t.toLocaleString("zh-CN"),")"]}),e.jsx("input",{type:"range",min:1,max:t,value:j,onChange:xe,disabled:t===0}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",min:1,max:t,value:C,onChange:je,onBlur:pe,disabled:t===0}),e.jsx("span",{className:"unit",children:"äºº"})]})]}),e.jsxs("div",{className:"equipment-section",children:[e.jsx("h4",{children:"å†›æ¢°é…ç½®"}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["é“ç‚® (åº“å­˜: ",d.toLocaleString("zh-CN"),")"]}),e.jsx("input",{type:"range",min:0,max:d,value:i,onChange:fe,disabled:d===0}),e.jsx("div",{className:"number-input-wrapper",children:e.jsx("input",{type:"number",min:0,max:d,value:I,onChange:ve,onBlur:Ne,disabled:d===0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["æˆ˜é©¬ (åº“å­˜: ",c.toLocaleString("zh-CN"),")"]}),e.jsx("input",{type:"range",min:0,max:c,value:D,onChange:ge,disabled:c===0}),e.jsx("div",{className:"number-input-wrapper",children:e.jsx("input",{type:"number",min:0,max:c,value:u,onChange:be,onBlur:ye,disabled:c===0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["å¤§ç­’ (åº“å­˜: ",o.toLocaleString("zh-CN"),")"]}),e.jsx("input",{type:"range",min:0,max:o,value:S,onChange:Ce,disabled:o===0}),e.jsx("div",{className:"number-input-wrapper",children:e.jsx("input",{type:"number",min:0,max:o,value:_,onChange:ke,onBlur:oe,disabled:o===0})})]})]}),e.jsxs("div",{className:`form-group ${T.locationId&&B.locationId?"has-error":""}`,children:[e.jsx("label",{htmlFor:"location",children:"åˆ›å»ºä½ç½® *"}),e.jsxs("select",{id:"location",value:J,onChange:Se,className:T.locationId&&B.locationId?"error-input":"",children:[e.jsx("option",{value:"",children:"è¯·é€‰æ‹©ä½ç½®"}),r.map(w=>e.jsxs("option",{value:w.id,children:[w.districtName," (",w.provinceName,")"]},w.id))]}),T.locationId&&B.locationId&&e.jsx("span",{className:"error-message",children:T.locationId})]})]}),e.jsxs("div",{className:"create-legion-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:l,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:L,disabled:t===0,children:"åˆ›å»ºå†›å›¢"})]})]})}),ne&&R&&e.jsx("div",{className:"conflict-dialog-overlay",onClick:z,children:e.jsxs("div",{className:"conflict-dialog",onClick:w=>w.stopPropagation(),children:[e.jsx("div",{className:"conflict-dialog-header",children:e.jsx("h3",{children:"âš ï¸ å°†é¢†å†²çª"})}),e.jsxs("div",{className:"conflict-dialog-content",children:[e.jsxs("p",{children:["å°†é¢† ",e.jsx("strong",{children:(re=a.find(w=>w.id===v))==null?void 0:re.name}),"å·²æ˜¯å†›å›¢ã€Œ",e.jsx("strong",{children:R.name}),"ã€çš„æŒ‡æŒ¥å®˜ã€‚"]}),e.jsx("p",{children:"å¦‚æœç»§ç»­ï¼ŒåŸå†›å›¢å°†è¢«è§£æ•£ï¼Œèµ„æºå°†è¿”è¿˜åº“å­˜ã€‚"}),e.jsx("p",{className:"warning-text",children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ"})]}),e.jsxs("div",{className:"conflict-dialog-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:z,children:"å–æ¶ˆ"}),e.jsx("button",{className:"danger-btn",onClick:M,children:"è§£æ•£åŸå†›å›¢å¹¶åˆ›å»º"})]})]})})]}):null}function da({isOpen:s,legion:a,maxIdleSoldiers:r,onConfirm:t,onDisband:d,onCancel:c}){const[o,f]=n.useState(0),[l,k]=n.useState("0"),[m,h]=n.useState(!1),v=a?a.soldierCount+r:0;n.useEffect(()=>{s&&a&&(f(a.soldierCount),k(a.soldierCount.toString()),h(!1))},[s,a]);const y=n.useCallback(I=>{const N=A(parseInt(I.target.value,10)||0,0,v);f(N),k(N.toString())},[v]),j=n.useCallback(I=>{k(I.target.value);const N=parseInt(I.target.value,10);isNaN(N)||f(A(N,0,v))},[v]),g=n.useCallback(()=>{const I=parseInt(l,10),N=A(isNaN(I)?0:I,0,v);f(N),k(N.toString())},[l,v]),C=n.useCallback(()=>{if(a){if(o===0){h(!0);return}t(a.id,o)}},[a,o,t]),b=n.useCallback(()=>{a&&d(a.id)},[a,d]),i=n.useCallback(()=>{h(!1)},[]);if(!s||!a)return null;const E=o-a.soldierCount;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"edit-soldiers-overlay",onClick:c,children:e.jsxs("div",{className:"edit-soldiers-dialog",onClick:I=>I.stopPropagation(),children:[e.jsxs("div",{className:"edit-soldiers-header",children:[e.jsxs("h3",{children:["ç¼–è¾‘äººæ•° - ",a.name]}),e.jsx("button",{className:"close-btn",onClick:c,children:"Ã—"})]}),e.jsxs("div",{className:"edit-soldiers-content",children:[e.jsxs("div",{className:"info-section",children:[e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"label",children:"å½“å‰äººæ•°:"}),e.jsxs("span",{className:"value",children:[a.soldierCount.toLocaleString("zh-CN")," äºº"]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"label",children:"åº“å­˜é—²ç½®å£«å…µ:"}),e.jsxs("span",{className:"value",children:[r.toLocaleString("zh-CN")," äºº"]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"label",children:"å¯è°ƒæ•´èŒƒå›´:"}),e.jsxs("span",{className:"value",children:["0 - ",v.toLocaleString("zh-CN")," äºº"]})]})]}),e.jsxs("div",{className:"input-section",children:[e.jsx("label",{children:"æ–°äººæ•°:"}),e.jsx("input",{type:"range",min:0,max:v,value:o,onChange:y}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",min:0,max:v,value:l,onChange:j,onBlur:g}),e.jsx("span",{className:"unit",children:"äºº"})]})]}),e.jsxs("div",{className:"preview-section",children:[E>0&&e.jsxs("div",{className:"preview-item increase",children:[e.jsx("span",{children:"ä»åº“å­˜è°ƒå…¥:"}),e.jsxs("span",{children:["+",E.toLocaleString("zh-CN")," äºº"]})]}),E<0&&e.jsxs("div",{className:"preview-item decrease",children:[e.jsx("span",{children:"è¿”è¿˜åº“å­˜:"}),e.jsxs("span",{children:[Math.abs(E).toLocaleString("zh-CN")," äºº"]})]}),E===0&&e.jsx("div",{className:"preview-item unchanged",children:e.jsx("span",{children:"äººæ•°æœªå˜åŒ–"})})]}),o===0&&e.jsx("div",{className:"warning-section",children:"âš ï¸ äººæ•°ä¸º0å°†è§£æ•£å†›å›¢"})]}),e.jsxs("div",{className:"edit-soldiers-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:c,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:C,disabled:E===0,children:o===0?"è§£æ•£å†›å›¢":"ç¡®è®¤ä¿®æ”¹"})]})]})}),m&&e.jsx("div",{className:"disband-confirm-overlay",onClick:i,children:e.jsxs("div",{className:"disband-confirm-dialog",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"disband-confirm-header",children:e.jsx("h3",{children:"âš ï¸ ç¡®è®¤è§£æ•£"})}),e.jsxs("div",{className:"disband-confirm-content",children:[e.jsxs("p",{children:["ç¡®å®šè¦è§£æ•£å†›å›¢ã€Œ",e.jsx("strong",{children:a.name}),"ã€å—ï¼Ÿ"]}),e.jsx("p",{children:"å†›å›¢èµ„æºå°†è¿”è¿˜åº“å­˜ï¼š"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["å£«å…µ: ",a.soldierCount.toLocaleString("zh-CN")," äºº"]}),e.jsxs("li",{children:["é“ç‚®: ",a.rifles]}),e.jsxs("li",{children:["æˆ˜é©¬: ",a.horses]}),e.jsxs("li",{children:["å¤§ç­’: ",a.cannons]})]}),e.jsx("p",{className:"warning-text",children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼"})]}),e.jsxs("div",{className:"disband-confirm-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:i,children:"å–æ¶ˆ"}),e.jsx("button",{className:"danger-btn",onClick:b,children:"ç¡®è®¤è§£æ•£"})]})]})})]})}function ua({isOpen:s,legion:a,maxRifles:r,maxHorses:t,maxCannons:d,onConfirm:c,onCancel:o}){const[f,l]=n.useState(0),[k,m]=n.useState("0"),[h,v]=n.useState(0),[y,j]=n.useState("0"),[g,C]=n.useState(0),[b,i]=n.useState("0"),E=a?a.rifles+r:0,I=a?a.horses+t:0,N=a?a.cannons+d:0;n.useEffect(()=>{s&&a&&(l(a.rifles),m(a.rifles.toString()),v(a.horses),j(a.horses.toString()),C(a.cannons),i(a.cannons.toString()))},[s,a]);const D=n.useCallback(R=>{const O=A(parseInt(R.target.value,10)||0,0,E);l(O),m(O.toString())},[E]),q=n.useCallback(R=>{m(R.target.value);const O=parseInt(R.target.value,10);isNaN(O)||l(A(O,0,E))},[E]),u=n.useCallback(()=>{const R=parseInt(k,10),O=A(isNaN(R)?0:R,0,E);l(O),m(O.toString())},[k,E]),p=n.useCallback(R=>{const O=A(parseInt(R.target.value,10)||0,0,I);v(O),j(O.toString())},[I]),S=n.useCallback(R=>{j(R.target.value);const O=parseInt(R.target.value,10);isNaN(O)||v(A(O,0,I))},[I]),V=n.useCallback(()=>{const R=parseInt(y,10),O=A(isNaN(R)?0:R,0,I);v(O),j(O.toString())},[y,I]),_=n.useCallback(R=>{const O=A(parseInt(R.target.value,10)||0,0,N);C(O),i(O.toString())},[N]),U=n.useCallback(R=>{i(R.target.value);const O=parseInt(R.target.value,10);isNaN(O)||C(A(O,0,N))},[N]),J=n.useCallback(()=>{const R=parseInt(b,10),O=A(isNaN(R)?0:R,0,N);C(O),i(O.toString())},[b,N]),G=n.useCallback(()=>{a&&c(a.id,{rifles:f,horses:h,cannons:g})},[a,f,h,g,c]);if(!s||!a)return null;const T=f-a.rifles,F=h-a.horses,B=g-a.cannons,H=T!==0||F!==0||B!==0;return e.jsx("div",{className:"edit-equipment-overlay",onClick:o,children:e.jsxs("div",{className:"edit-equipment-dialog",onClick:R=>R.stopPropagation(),children:[e.jsxs("div",{className:"edit-equipment-header",children:[e.jsxs("h3",{children:["ç¼–è¾‘è£…å¤‡ - ",a.name]}),e.jsx("button",{className:"close-btn",onClick:o,children:"Ã—"})]}),e.jsxs("div",{className:"edit-equipment-content",children:[e.jsxs("div",{className:"equipment-item",children:[e.jsxs("div",{className:"equipment-header",children:[e.jsx("span",{className:"equipment-name",children:"é“ç‚®"}),e.jsxs("span",{className:"equipment-info",children:["å½“å‰: ",a.rifles," | åº“å­˜: ",r]})]}),e.jsx("input",{type:"range",min:0,max:E,value:f,onChange:D}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",min:0,max:E,value:k,onChange:q,onBlur:u}),T!==0&&e.jsxs("span",{className:`diff ${T>0?"increase":"decrease"}`,children:[T>0?"+":"",T]})]})]}),e.jsxs("div",{className:"equipment-item",children:[e.jsxs("div",{className:"equipment-header",children:[e.jsx("span",{className:"equipment-name",children:"æˆ˜é©¬"}),e.jsxs("span",{className:"equipment-info",children:["å½“å‰: ",a.horses," | åº“å­˜: ",t]})]}),e.jsx("input",{type:"range",min:0,max:I,value:h,onChange:p}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",min:0,max:I,value:y,onChange:S,onBlur:V}),F!==0&&e.jsxs("span",{className:`diff ${F>0?"increase":"decrease"}`,children:[F>0?"+":"",F]})]})]}),e.jsxs("div",{className:"equipment-item",children:[e.jsxs("div",{className:"equipment-header",children:[e.jsx("span",{className:"equipment-name",children:"å¤§ç­’"}),e.jsxs("span",{className:"equipment-info",children:["å½“å‰: ",a.cannons," | åº“å­˜: ",d]})]}),e.jsx("input",{type:"range",min:0,max:N,value:g,onChange:_}),e.jsxs("div",{className:"number-input-wrapper",children:[e.jsx("input",{type:"number",min:0,max:N,value:b,onChange:U,onBlur:J}),B!==0&&e.jsxs("span",{className:`diff ${B>0?"increase":"decrease"}`,children:[B>0?"+":"",B]})]})]})]}),e.jsxs("div",{className:"edit-equipment-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:o,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:G,disabled:!H,children:"ç¡®è®¤ä¿®æ”¹"})]})]})})}function ma({isOpen:s,legion:a,onConfirm:r,onCancel:t}){if(!s||!a)return null;const d=()=>{r(a.id)};return e.jsx("div",{className:"disband-legion-overlay",onClick:t,children:e.jsxs("div",{className:"disband-legion-dialog",onClick:c=>c.stopPropagation(),children:[e.jsx("div",{className:"disband-legion-header",children:e.jsx("h3",{children:"âš ï¸ ç¡®è®¤è§£æ•£å†›å›¢"})}),e.jsxs("div",{className:"disband-legion-content",children:[e.jsxs("p",{children:["ç¡®å®šè¦è§£æ•£å†›å›¢ã€Œ",e.jsx("strong",{children:a.name}),"ã€å—ï¼Ÿ"]}),e.jsxs("div",{className:"return-resources",children:[e.jsx("p",{children:"ä»¥ä¸‹èµ„æºå°†è¿”è¿˜åº“å­˜ï¼š"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("span",{className:"resource-name",children:"å£«å…µ"}),e.jsxs("span",{className:"resource-value",children:[a.soldierCount.toLocaleString("zh-CN")," äºº"]})]}),e.jsxs("li",{children:[e.jsx("span",{className:"resource-name",children:"é“ç‚®"}),e.jsx("span",{className:"resource-value",children:a.rifles})]}),e.jsxs("li",{children:[e.jsx("span",{className:"resource-name",children:"æˆ˜é©¬"}),e.jsx("span",{className:"resource-value",children:a.horses})]}),e.jsxs("li",{children:[e.jsx("span",{className:"resource-name",children:"å¤§ç­’"}),e.jsx("span",{className:"resource-value",children:a.cannons})]})]})]}),e.jsxs("p",{className:"commander-info",children:["å°†é¢†ã€Œ",a.commanderName,"ã€å°†æ¢å¤é—²ç½®çŠ¶æ€ã€‚"]}),e.jsx("p",{className:"warning-text",children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼"})]}),e.jsxs("div",{className:"disband-legion-footer",children:[e.jsx("button",{className:"cancel-btn",onClick:t,children:"å–æ¶ˆ"}),e.jsx("button",{className:"danger-btn",onClick:d,children:"ç¡®è®¤è§£æ•£"})]})]})})}const Ee=[{type:"agriculture",name:"å†œä¸š",description:"æ–‡æ²»å±æ€§ï¼Œ5000çŸ³/æ¬¡ï¼Œ5ç‚¹åŸºç¡€"},{type:"commerce",name:"å•†ä¸š",description:"æ™ºç•¥å±æ€§ï¼Œè‡ªå®šä¹‰æŠ•å…¥é‡‘é¢"},{type:"navy",name:"æ°´å†›",description:"æ­¦åŠŸå±æ€§ï¼Œ8000çŸ³/æ¬¡ï¼Œ4ç‚¹åŸºç¡€"},{type:"armament",name:"æ­¦å¤‡",description:"æ­¦å‹‡å±æ€§ï¼Œ4000çŸ³/æ¬¡ï¼Œ6ç‚¹åŸºç¡€"}];function ha({factionId:s,onInvestmentComplete:a}){var G;const[r,t]=n.useState(null),[d,c]=n.useState([]),[o,f]=n.useState(!0),[l,k]=n.useState(null),[m,h]=n.useState(null),[v,y]=n.useState(""),[j,g]=n.useState(1e3),[C,b]=n.useState(null),[i,E]=n.useState(!1),[I,N]=n.useState(!1),[D,q]=n.useState(!1),[u,p]=n.useState(null),[S,V]=n.useState(!1);n.useEffect(()=>{_()},[s]),n.useEffect(()=>{m&&v?U():b(null)},[m,v,j]);async function _(){f(!0),k(null);try{const[T,F]=await Promise.all([ls(s),is(s)]);T.success&&T.data?t(T.data):k(T.error||"è·å–æŠ•èµ„çŠ¶æ€å¤±è´¥"),F.success&&F.data&&c(F.data)}catch{k("ç½‘ç»œé”™è¯¯")}finally{f(!1)}}async function U(){if(!(!m||!v)){E(!0);try{const F=await rs(m,v,m==="commerce"?j:void 0,s);F.success&&F.data&&b(F.data)}catch(T){console.error("è·å–é¢„è§ˆå¤±è´¥:",T)}finally{E(!1)}}}async function J(){if(!(!m||!v||!(C!=null&&C.canExecute))){q(!0);try{const F=await cs(m,v,m==="commerce"?j:void 0,s);F.success&&F.data?(p(F.data),V(!0),N(!1),await _(),a==null||a()):alert(F.error||"æŠ•èµ„æ‰§è¡Œå¤±è´¥")}catch{alert("ç½‘ç»œé”™è¯¯")}finally{q(!1)}}}return o?e.jsx("div",{className:"investment-panel loading",children:e.jsx("p",{children:"åŠ è½½ä¸­..."})}):l||!r?e.jsxs("div",{className:"investment-panel error",children:[e.jsx("p",{children:l||"æ•°æ®åŠ è½½å¤±è´¥"}),e.jsx("button",{onClick:_,children:"é‡è¯•"})]}):e.jsxs("div",{className:"investment-panel",children:[e.jsxs("div",{className:"investment-status",children:[e.jsx("h3",{children:"æŠ•èµ„çŠ¶æ€"}),e.jsxs("div",{className:"status-grid",children:[e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"åº“å­˜"}),e.jsxs("span",{className:"value",children:[r.treasury.toLocaleString()," çŸ³"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"å†œä¸š"}),e.jsxs("span",{className:"value",children:[r.agriculturePoints,"ç‚¹ (",r.agricultureLevel,")"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"å•†ä¸š"}),e.jsxs("span",{className:"value",children:[r.commercePoints,"ç‚¹ (",r.commerceLevel,")"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"æ°´å†›"}),e.jsxs("span",{className:"value",children:[r.navyPoints,"ç‚¹ (",r.navyLevel,")"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"æ­¦å¤‡"}),e.jsxs("span",{className:"value",children:[r.armamentPoints,"ç‚¹ (",r.armamentLevel,")"]})]})]})]}),e.jsxs("div",{className:"investment-form",children:[e.jsx("h3",{children:"æ‰§è¡ŒæŠ•èµ„"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æŠ•èµ„é¡¹ç›®"}),e.jsx("div",{className:"type-buttons",children:Ee.map(({type:T,name:F,description:B})=>e.jsx("button",{className:`type-btn ${m===T?"selected":""}`,onClick:()=>h(T),title:B,children:F},T))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ‰§è¡Œæ­¦å£«"}),d.length===0?e.jsx("p",{className:"no-samurai",children:"æ²¡æœ‰å¯ç”¨çš„æ­¦å£«ï¼ˆè¡ŒåŠ¨åŠ›ä¸è¶³ï¼‰"}):e.jsxs("select",{value:v,onChange:T=>y(T.target.value),children:[e.jsx("option",{value:"",children:"è¯·é€‰æ‹©æ­¦å£«"}),d.map(T=>e.jsxs("option",{value:T.id,children:[T.name," (æ­¦åŠŸ:",T.martialValue," æ–‡æ²»:",T.civilValue," è¡ŒåŠ¨åŠ›:",T.actionPoints,")"]},T.id))]})]}),m==="commerce"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æŠ•å…¥é‡‘é¢"}),e.jsxs("div",{className:"amount-input",children:[e.jsx("input",{type:"range",min:1e3,max:Math.min(r.treasury,1e5),step:1e3,value:j,onChange:T=>g(Number(T.target.value))}),e.jsx("input",{type:"number",min:1e3,max:r.treasury,step:1e3,value:j,onChange:T=>{const F=Number(T.target.value);g(Math.max(1e3,Math.min(r.treasury,F)))}}),e.jsx("span",{className:"unit",children:"çŸ³"})]})]}),C&&e.jsxs("div",{className:"investment-preview",children:[e.jsx("h4",{children:"é¢„è®¡æ•ˆæœ"}),C.canExecute?e.jsxs("div",{className:"preview-content",children:[e.jsxs("div",{className:"preview-row",children:[e.jsx("span",{children:"ä½¿ç”¨å±æ€§"}),e.jsxs("span",{children:[C.attributeName,": ",C.samuraiAttribute]})]}),e.jsxs("div",{className:"preview-row",children:[e.jsx("span",{children:"æˆåŠŸç‡"}),e.jsxs("span",{className:"success-rate",children:[(C.successRate*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"preview-row",children:[e.jsx("span",{children:"ä¿®æ­£ç³»æ•°"}),e.jsx("span",{children:C.modifierCoefficient.toFixed(2)})]}),e.jsxs("div",{className:"preview-row",children:[e.jsx("span",{children:"èŠ±è´¹"}),e.jsxs("span",{children:[C.cost.toLocaleString()," çŸ³"]})]}),e.jsxs("div",{className:"preview-outcomes",children:[e.jsxs("div",{className:"outcome critical",children:[e.jsx("span",{className:"outcome-label",children:"å¤§æˆåŠŸ (<5)"}),e.jsxs("span",{className:"outcome-value",children:["+",C.expectedPointsOnCritical,"ç‚¹"]})]}),e.jsxs("div",{className:"outcome success",children:[e.jsx("span",{className:"outcome-label",children:"æˆåŠŸ"}),e.jsxs("span",{className:"outcome-value",children:["+",C.expectedPointsOnSuccess,"ç‚¹"]})]}),e.jsxs("div",{className:"outcome failure",children:[e.jsx("span",{className:"outcome-label",children:"å¤±è´¥"}),e.jsxs("span",{className:"outcome-value",children:["+",C.expectedPointsOnFailure,"ç‚¹"]})]})]})]}):e.jsx("div",{className:"preview-error",children:e.jsx("p",{children:C.error})})]}),e.jsx("button",{className:"execute-btn",disabled:!m||!v||!(C!=null&&C.canExecute)||i,onClick:()=>N(!0),children:"æ‰§è¡ŒæŠ•èµ„"})]}),I&&C&&e.jsx("div",{className:"dialog-overlay",children:e.jsxs("div",{className:"dialog confirm-dialog",children:[e.jsx("h3",{children:"ç¡®è®¤æŠ•èµ„"}),e.jsxs("p",{children:["ç¡®å®šè¦æ‰§è¡Œ ",e.jsx("strong",{children:(G=Ee.find(T=>T.type===m))==null?void 0:G.name})," æŠ•èµ„å—ï¼Ÿ"]}),e.jsxs("p",{children:["èŠ±è´¹: ",C.cost.toLocaleString()," çŸ³"]}),e.jsxs("p",{children:["æˆåŠŸç‡: ",(C.successRate*100).toFixed(0),"%"]}),e.jsxs("div",{className:"dialog-buttons",children:[e.jsx("button",{className:"cancel-btn",onClick:()=>N(!1),disabled:D,children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm-btn",onClick:J,disabled:D,children:D?"æ‰§è¡Œä¸­...":"ç¡®è®¤"})]})]})}),S&&u&&e.jsx("div",{className:"dialog-overlay",children:e.jsxs("div",{className:`dialog result-dialog ${u.outcome}`,children:[e.jsxs("h3",{children:[u.outcome==="critical_success"&&"ğŸ‰ å¤§æˆåŠŸï¼",u.outcome==="success"&&"âœ… æˆåŠŸï¼",u.outcome==="failure"&&"âŒ å¤±è´¥"]}),e.jsxs("div",{className:"result-content",children:[e.jsxs("p",{className:"roll-result",children:["D100: ",u.roll]}),e.jsx("p",{className:"points-gained",children:u.outcome!=="failure"?`è·å¾— ${u.pointsGained} ç‚¹`:"æœªè·å¾—ç‚¹æ•°"}),e.jsxs("p",{className:"new-level",children:["å½“å‰ç­‰çº§: ",u.newLevel," (",u.newPoints,"ç‚¹)"]})]}),e.jsx("button",{className:"close-btn",onClick:()=>{V(!1),p(null),h(null),y(""),b(null)},children:"ç¡®å®š"})]})})]})}function xa({onReportSubmitted:s}){const[a,r]=n.useState(!1),[t,d]=n.useState(""),[c,o]=n.useState(!1),[f,l]=n.useState(null),k=async()=>{o(!0),l(null);try{const h=await Fs(t||void 0);h.success?(l({success:!0,message:"é”™è¯¯æŠ¥å‘Šå·²æäº¤ï¼Œç®¡ç†å‘˜ä¼šå°½å¿«å¤„ç†"}),d(""),s==null||s(),setTimeout(()=>{r(!1),l(null)},3e3)):l({success:!1,message:h.error||"æäº¤å¤±è´¥"})}catch{l({success:!1,message:"ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•"})}finally{o(!1)}},m=()=>{r(!1),d(""),l(null)};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"error-report-button",onClick:()=>r(!0),title:"æŠ¥å‘Šé—®é¢˜",children:"ğŸ› æŠ¥é”™"}),a&&e.jsx("div",{className:"error-report-overlay",onClick:m,children:e.jsxs("div",{className:"error-report-dialog",onClick:h=>h.stopPropagation(),children:[e.jsx("h3",{children:"æŠ¥å‘Šé—®é¢˜"}),e.jsx("p",{className:"error-report-hint",children:"å¦‚æœæ‚¨é‡åˆ°äº†é—®é¢˜ï¼Œè¯·æè¿°ä¸€ä¸‹æƒ…å†µã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è®°å½•æ‚¨æœ€è¿‘çš„æ“ä½œï¼Œå¸®åŠ©ç®¡ç†å‘˜å®šä½é—®é¢˜ã€‚"}),e.jsx("textarea",{className:"error-report-textarea",placeholder:"è¯·æè¿°æ‚¨é‡åˆ°çš„é—®é¢˜ï¼ˆå¯é€‰ï¼‰",value:t,onChange:h=>d(h.target.value),disabled:c,rows:4}),f&&e.jsx("div",{className:`error-report-result ${f.success?"success":"error"}`,children:f.message}),e.jsxs("div",{className:"error-report-actions",children:[e.jsx("button",{className:"error-report-cancel",onClick:m,disabled:c,children:"å–æ¶ˆ"}),e.jsx("button",{className:"error-report-submit",onClick:k,disabled:c,children:c?"æäº¤ä¸­...":"æäº¤æŠ¥å‘Š"})]})]})})]})}function ja({data:s}){const[a,r]=n.useState(!1),t=s.maintenanceCost||{infantryCost:0,horseCost:0,rifleCost:0,cannonCost:0,legionExtraCost:0,samuraiSalary:0,subtotal:0,armamentModifier:0,total:0},d=[{name:"é¢†åœ°çŸ³é«˜",value:s.territoryKokudaka,note:"æ‰€æœ‰é¢†åœ°çš„åŸºç¡€çŸ³é«˜æ€»å’Œ"},{name:"åŠ æˆç³»æ•°æ•ˆæœ",value:Math.floor(s.territoryKokudaka*s.bonusCoefficient),note:`é¢†åœ°çŸ³é«˜ Ã— ${(s.bonusCoefficient*100).toFixed(0)}%`},{name:"ç‰¹äº§çŸ³é«˜",value:s.specialProductKokudaka,note:"ç‰¹äº§å¸¦æ¥çš„é¢å¤–çŸ³é«˜æ”¶å…¥"},{name:"é¢†å†…è´¢äº§",value:s.integrationBonus,note:"å®Œå…¨å é¢†ä»¤åˆ¶å›½çš„æ•´åˆå¥–åŠ±"},{name:"äº§ä¸šçŸ³é«˜",value:s.industryKokudaka,note:"å®¶æ—äº§ä¸šå¸¦æ¥çš„çŸ³é«˜"}],o=[{name:"æ­¥å’ç»´æŠ¤è´¹",value:-t.infantryCost,note:`${s.totalSoldiers}äºº Ã— 4çŸ³/äºº`},{name:"æˆ˜é©¬ç»´æŠ¤è´¹",value:-t.horseCost,note:`${s.horses+s.legions.reduce((h,v)=>h+v.horses,0)}åŒ¹ Ã— 12çŸ³/åŒ¹`},{name:"é“ç‚®ç»´æŠ¤è´¹",value:-t.rifleCost,note:`${s.rifles+s.legions.reduce((h,v)=>h+v.rifles,0)}æŒº Ã— 3çŸ³/æŒº`},{name:"å¤§ç­’ç»´æŠ¤è´¹",value:-t.cannonCost,note:`${s.cannons+s.legions.reduce((h,v)=>h+v.cannons,0)}é—¨ Ã— 8çŸ³/é—¨`},{name:"å†›å›¢é¢å¤–è´¹ç”¨",value:-t.legionExtraCost,note:`${s.legionSoldiers}äºº Ã— 4çŸ³/äºº`},{name:"æ­¦å£«ä¿¸ç¦„",value:-t.samuraiSalary,note:`${s.samurais.length}äºº Ã— 2000çŸ³/äºº`}].filter(h=>h.value!==0),f=s.surfaceKokudaka,l=s.income,k=t.total,m=l-k;return e.jsxs("div",{className:"income-expense-breakdown",children:[e.jsxs("div",{className:"breakdown-header",onClick:()=>r(!a),children:[e.jsxs("span",{className:"breakdown-title",children:[a?"â–¼":"â–¶"," æ”¶æ”¯æ˜ç»†è¡¨"]}),e.jsxs("span",{className:`net-income ${m>=0?"positive":"negative"}`,children:["å‡€æ”¶å…¥: ",m>=0?"+":"",ee(m),"ä¸‡çŸ³"]})]}),a&&e.jsxs("div",{className:"breakdown-content",children:[e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{className:"section-title income-title",children:"è¡¨é¢çŸ³é«˜ç»„æˆ"}),e.jsxs("div",{className:"breakdown-items",children:[d.map((h,v)=>e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:h.name}),e.jsx("span",{className:"item-note",children:h.note})]}),e.jsxs("span",{className:`item-value ${h.value>=0?"positive":"negative"}`,children:[h.value>=0?"+":"",ee(h.value),"ä¸‡çŸ³"]})]},v)),e.jsxs("div",{className:"breakdown-subtotal",children:[e.jsx("span",{children:"è¡¨é¢çŸ³é«˜åˆè®¡"}),e.jsxs("span",{className:"positive",children:[ee(f),"ä¸‡çŸ³"]})]})]})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{className:"section-title income-title",children:"å¹´åº¦æ”¶å…¥"}),e.jsx("div",{className:"breakdown-items",children:e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:"å¹´åº¦æ”¶å…¥"}),e.jsxs("span",{className:"item-note",children:["è¡¨é¢çŸ³é«˜ Ã— ç¨ç‡(",(s.taxRate*100).toFixed(0),"%) Ã— 0.4"]})]}),e.jsxs("span",{className:"item-value positive",children:["+",ee(l),"ä¸‡çŸ³"]})]})})]}),e.jsxs("div",{className:"breakdown-section",children:[e.jsx("h4",{className:"section-title expense-title",children:"å¹´åº¦æ”¯å‡º"}),e.jsxs("div",{className:"breakdown-items",children:[o.map((h,v)=>e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:h.name}),e.jsx("span",{className:"item-note",children:h.note})]}),e.jsxs("span",{className:"item-value negative",children:[ee(h.value),"ä¸‡çŸ³"]})]},v)),t.armamentModifier!==0&&e.jsxs("div",{className:"breakdown-item",children:[e.jsxs("div",{className:"item-info",children:[e.jsx("span",{className:"item-name",children:"æ­¦å¤‡ç­‰çº§ä¿®æ­£"}),e.jsxs("span",{className:"item-note",children:["å†›äº‹ç»´æŠ¤è´¹ Ã— ",(t.armamentModifier*100).toFixed(0),"%"]})]}),e.jsxs("span",{className:`item-value ${t.armamentModifier<0?"positive":"negative"}`,children:[t.armamentModifier<0?"+":"",ee(Math.floor((t.subtotal-t.samuraiSalary)*t.armamentModifier)),"ä¸‡çŸ³"]})]}),e.jsxs("div",{className:"breakdown-subtotal",children:[e.jsx("span",{children:"æ”¯å‡ºå°è®¡"}),e.jsxs("span",{className:"negative",children:["-",ee(k),"ä¸‡çŸ³"]})]})]})]}),e.jsxs("div",{className:"breakdown-total",children:[e.jsx("span",{children:"å¹´åº¦å‡€æ”¶å…¥"}),e.jsxs("span",{className:m>=0?"positive":"negative",children:[m>=0?"+":"",ee(m),"ä¸‡çŸ³"]})]}),e.jsxs("div",{className:"growth-rate",children:[e.jsx("span",{children:"è‡ªç„¶å¢é•¿ç‡"}),e.jsxs("span",{className:s.growthRate>=0?"positive":"negative",children:[s.growthRate>=0?"+":"",(s.growthRate*100).toFixed(1),"%"]})]})]})]})}function ee(s){return(s/1e4).toFixed(2)}function pa({user:s,onLogout:a,onOpenAdminPanel:r}){const[t,d]=n.useState(null),[c,o]=n.useState(!0),[f,l]=n.useState(null),[k,m]=n.useState(!1),[h,v]=n.useState(null),[y,j]=n.useState(!1),[g,C]=n.useState(null),[b,i]=n.useState(!1),[E,I]=n.useState(null),[N,D]=n.useState(!1),[q,u]=n.useState(!1),[p,S]=n.useState([]),[V,_]=n.useState([]),[U,J]=n.useState(!1),[G,T]=n.useState(!1),[F,B]=n.useState(!1),[H,R]=n.useState(null);n.useEffect(()=>{O()},[s]);const O=async()=>{o(!0),l(null);try{let L;if(s.type==="player"&&s.factionId)L=await Ge();else if(s.factionId)L=await Ye(s.factionId);else{l("æ— æ³•è·å–åŠ¿åŠ›æ•°æ®"),o(!1);return}L.success&&L.data?d(L.data):l(L.error||"è·å–æ•°æ®å¤±è´¥")}catch{l("ç½‘ç»œé”™è¯¯")}finally{o(!1)}},ne=async()=>{await ze(),a()};if(c)return e.jsxs("div",{className:"dashboard-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]});if(f||!t)return e.jsxs("div",{className:"dashboard-error",children:[e.jsx("p",{children:f||"æ•°æ®åŠ è½½å¤±è´¥"}),e.jsx("button",{onClick:O,children:"é‡è¯•"}),e.jsx("button",{onClick:ne,children:"è¿”å›ç™»å½•"})]});return e.jsxs("div",{className:"dashboard",children:[e.jsxs("header",{className:"dashboard-header",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("h1",{children:t.name}),e.jsxs("span",{className:"lord-name",children:["å®¶ä¸»ï¼š",t.lordName]})]}),e.jsxs("div",{className:"header-right",children:[e.jsx(xa,{}),r&&e.jsx("button",{className:"admin-btn",onClick:r,children:"ç®¡ç†é¢æ¿"}),e.jsx("button",{className:"logout-btn",onClick:ne,children:"é€€å‡ºç™»å½•"})]})]}),e.jsxs("main",{className:"dashboard-content",children:[e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"åŠ¿åŠ›æ¦‚å†µ"}),e.jsxs("div",{className:"info-grid",children:[e.jsx(X,{label:"è¡¨é¢çŸ³é«˜",value:ae(t.surfaceKokudaka),unit:"ä¸‡çŸ³"}),e.jsx(X,{label:"æ”¶å…¥",value:ae(t.income),unit:"ä¸‡çŸ³/å¹´"}),e.jsx(X,{label:"åº“å­˜çŸ³é«˜",value:ae(t.treasury??0),unit:"ä¸‡çŸ³"}),e.jsx(fa,{taxRate:t.taxRate,canChange:(E==null?void 0:E.canChange)??!0,onOpenSelector:fe}),e.jsx(X,{label:"é™†å†›ç­‰çº§",value:t.armyLevel,subValue:`Lv.${t.armyLevelNumber}`})]}),N&&e.jsx(va,{currentRate:t.taxRate,availableRates:(E==null?void 0:E.availableRates)??[.4,.6,.8],canChange:(E==null?void 0:E.canChange)??!0,onSelect:ve,onClose:()=>D(!1)})]}),e.jsxs("section",{className:"info-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"æ­¦åº“"}),e.jsx("button",{className:"purchase-btn",onClick:je,children:"è´­ä¹°è£…å¤‡"})]}),e.jsxs("div",{className:"info-grid",children:[e.jsx(X,{label:"é“ç‚®",value:le(t.rifles),unit:"æŒº"}),e.jsx(X,{label:"æˆ˜é©¬",value:le(t.horses),unit:"åŒ¹"}),e.jsx(X,{label:"å¤§ç­’",value:le(t.cannons),unit:"é—¨"})]})]}),e.jsxs("section",{className:"info-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"å…µåŠ›"}),e.jsxs("div",{className:"section-buttons",children:[e.jsx("button",{className:"recruit-btn",onClick:Z,children:"æ‹›å‹Ÿå£«å…µ"}),e.jsx("button",{className:"disband-btn",onClick:x,children:"è§£æ•£å£«å…µ"})]})]}),e.jsxs("div",{className:"info-grid",children:[e.jsx(X,{label:"æ€»å…µåŠ›",value:le(t.totalSoldiers),unit:"äºº"}),e.jsx(X,{label:"é—²ç½®å£«å…µ",value:le(t.idleSoldiers),unit:"äºº"}),e.jsx(X,{label:"å¯æ‹›å‹Ÿä¸Šé™",value:le(t.maxRecruitableSoldiers),unit:"äºº"}),e.jsx(X,{label:"å£«å…µç»´æŒæ¯”",value:`${(t.soldierMaintenanceRatio*100).toFixed(1)}%`,subValue:`åŠ æˆ: ${t.bonusCoefficient>=0?"+":""}${(t.bonusCoefficient*100).toFixed(0)}%`})]})]}),t.buffs.length>0&&e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"å¢ç›Šæ•ˆæœ"}),e.jsx("div",{className:"buffs-list",children:t.buffs.slice(0,10).map((L,M)=>e.jsxs("div",{className:"buff-item",children:[e.jsx("span",{className:"buff-name",children:L.name}),e.jsx("span",{className:"buff-effect",children:L.effect})]},M))})]}),e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"çŸ³é«˜è¯¦æƒ…"}),e.jsxs("div",{className:"detail-list",children:[e.jsx(te,{label:"é¢†åœ°çŸ³é«˜",value:ae(t.territoryKokudaka),unit:"ä¸‡çŸ³"}),e.jsx(te,{label:"ç‰¹äº§çŸ³é«˜",value:ae(t.specialProductKokudaka),unit:"ä¸‡çŸ³"}),e.jsx(te,{label:"é¢†å†…è´¢äº§",value:ae(t.integrationBonus),unit:"ä¸‡çŸ³"}),e.jsx(te,{label:"äº§ä¸šçŸ³é«˜",value:ae(t.industryKokudaka),unit:"ä¸‡çŸ³"}),e.jsx(te,{label:"åŠ æˆç³»æ•°",value:`${t.bonusCoefficient>=0?"+":""}${(t.bonusCoefficient*100).toFixed(0)}%`}),e.jsx(te,{label:"è‡ªç„¶å¢é•¿ç‡",value:`${t.growthRate>=0?"+":""}${(t.growthRate*100).toFixed(1)}%`})]})]}),e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"æŠ•èµ„ç³»ç»Ÿ"}),e.jsx(ha,{factionId:s.factionId,onInvestmentComplete:O})]}),t.territories.length>0&&e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"é¢†åœ°ä¸€è§ˆ"}),e.jsx(Zs,{territories:t.territories,legions:t.legions})]}),t.samurais.length>0&&e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"æ­¦å£«ä¸€è§ˆ"}),e.jsx(ea,{samurais:t.samurais})]}),t.diplomacy.length>0&&e.jsxs("section",{className:"info-section",children:[e.jsx("h2",{children:"å¤–äº¤å…³ç³»"}),e.jsx(na,{diplomacy:t.diplomacy})]}),e.jsxs("section",{className:"info-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h2",{children:"å†›å›¢ä¸€è§ˆ"}),e.jsx("button",{className:"create-legion-btn",onClick:Ne,children:"æ–°å»ºå†›å›¢"})]}),t.legions.length>0?e.jsx(ta,{legions:t.legions,onDisband:ye,onEditSoldiers:Ce,onEditEquipment:ke}):e.jsx("div",{className:"empty-list",children:"æš‚æ— å†›å›¢"})]}),e.jsx(ja,{data:t})]}),e.jsx(ia,{isOpen:k,maxValue:(h==null?void 0:h.availableToRecruit)??0,currentIdleSoldiers:t.idleSoldiers,onConfirm:Q,onCancel:ie}),e.jsx(ra,{isOpen:y,maxValue:(g==null?void 0:g.maxDisbandable)??0,currentIdleSoldiers:t.idleSoldiers,treasury:t.treasury??0,costPerSoldier:(g==null?void 0:g.costPerSoldier)??2,onConfirm:K,onCancel:xe}),e.jsx(ca,{isOpen:b,treasury:t.treasury??0,onConfirm:pe,onCancel:()=>i(!1)}),e.jsx(oa,{isOpen:q,commanders:p,territories:V,maxSoldiers:t.idleSoldiers,maxRifles:t.rifles,maxHorses:t.horses,maxCannons:t.cannons,onConfirm:be,onCancel:()=>u(!1),onCheckConflict:ge}),e.jsx(da,{isOpen:U,legion:H,maxIdleSoldiers:t.idleSoldiers,onConfirm:Se,onDisband:oe,onCancel:()=>{J(!1),R(null)}}),e.jsx(ua,{isOpen:G,legion:H,maxRifles:t.rifles,maxHorses:t.horses,maxCannons:t.cannons,onConfirm:de,onCancel:()=>{T(!1),R(null)}}),e.jsx(ma,{isOpen:F,legion:H,onConfirm:oe,onCancel:()=>{B(!1),R(null)}})]});async function Z(){const L=await Qe(s.factionId);L.success&&L.data?(v(L.data),m(!0)):alert(L.error||"è·å–æ‹›å‹Ÿä¿¡æ¯å¤±è´¥")}async function Q(L){const M=await We(L,s.factionId);M.success?(m(!1),await O()):alert(M.error||"æ‹›å‹Ÿå¤±è´¥")}function ie(){m(!1)}async function x(){const L=await As(s.factionId);L.success&&L.data?(C(L.data),j(!0)):alert(L.error||"è·å–è§£æ•£ä¿¡æ¯å¤±è´¥")}async function K(L){const M=await Bs(L,s.factionId);M.success?(j(!1),await O()):alert(M.error||"è§£æ•£å¤±è´¥")}function xe(){j(!1)}function je(){i(!0)}async function pe(L,M,z){const re=await zs(L,M,z,s.factionId);re.success?(i(!1),await O()):alert(re.error||"è´­ä¹°å¤±è´¥")}async function fe(){const L=await Hs(s.factionId);if(L.success&&L.data){if(I(L.data),!L.data.canChange){alert("æœ¬å›åˆå·²æ›´æ”¹è¿‡ç¨ç‡ï¼Œæ— æ³•å†æ¬¡æ›´æ”¹");return}D(!0)}else alert(L.error||"è·å–ç¨ç‡ä¿¡æ¯å¤±è´¥")}async function ve(L){if(!confirm(`ç¡®å®šè¦å°†ç¨ç‡æ›´æ”¹ä¸º ${(L*100).toFixed(0)}% å—ï¼Ÿ

æ³¨æ„ï¼šæ¯å›åˆåªèƒ½æ›´æ”¹ä¸€æ¬¡ç¨ç‡ï¼`))return;const M=await Gs(L,s.factionId);M.success?(D(!1),await O(),I(z=>z?{...z,canChange:!1}:null)):alert(M.error||"æ›´æ”¹ç¨ç‡å¤±è´¥")}async function Ne(){const[L,M]=await Promise.all([Xe(s.factionId),Ze(s.factionId)]);L.success&&L.data&&S(L.data),M.success&&M.data&&_(M.data),u(!0)}async function ge(L){const M=await es(L);return M.success&&M.data?M.data:{hasConflict:!1}}async function be(L){const M={name:L.name,commanderId:L.commanderId,soldierCount:L.soldierCount,rifles:L.rifles,horses:L.horses,cannons:L.cannons,locationId:L.locationId,factionId:s.factionId,forceReassign:L.forceReassign},z=await ss(M);z.success?(u(!1),await O()):alert(z.error||"åˆ›å»ºå†›å›¢å¤±è´¥")}function ye(L){R(L),B(!0)}function Ce(L){R(L),J(!0)}function ke(L){R(L),T(!0)}async function oe(L){const M=await as(L,s.factionId);M.success?(B(!1),J(!1),R(null),await O()):alert(M.error||"è§£æ•£å†›å›¢å¤±è´¥")}async function Se(L,M){const z=await ns(L,M,s.factionId);z.success?(J(!1),R(null),await O()):alert(z.error||"ä¿®æ”¹äººæ•°å¤±è´¥")}async function de(L,M){const z=await ts(L,M,s.factionId);z.success?(T(!1),R(null),await O()):alert(z.error||"ä¿®æ”¹è£…å¤‡å¤±è´¥")}}function X({label:s,value:a,unit:r,subValue:t}){return e.jsxs("div",{className:"info-card",children:[e.jsx("div",{className:"info-label",children:s}),e.jsxs("div",{className:"info-value",children:[a,r&&e.jsx("span",{className:"info-unit",children:r})]}),t&&e.jsx("div",{className:"info-sub",children:t})]})}function te({label:s,value:a,unit:r}){return e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:s}),e.jsxs("span",{className:"detail-value",children:[a,r&&e.jsx("span",{className:"detail-unit",children:r})]})]})}function le(s){return Math.floor(s).toLocaleString("zh-CN")}function ae(s){return(s/1e4).toFixed(2)}function fa({taxRate:s,canChange:a,onOpenSelector:r}){return e.jsxs("div",{className:"info-card tax-rate-card",onClick:r,children:[e.jsx("div",{className:"info-label",children:"ç¨ç‡"}),e.jsxs("div",{className:"info-value clickable",children:[`${(s*100).toFixed(0)}%`,e.jsx("span",{className:"edit-icon",children:"âœ"})]}),!a&&e.jsx("div",{className:"info-sub warning",children:"æœ¬å›åˆå·²æ›´æ”¹"})]})}function va({currentRate:s,availableRates:a,canChange:r,onSelect:t,onClose:d}){return e.jsxs("div",{className:"tax-rate-selector",children:[e.jsxs("div",{className:"selector-header",children:[e.jsx("span",{children:"é€‰æ‹©ç¨ç‡"}),e.jsx("button",{className:"close-btn",onClick:d,children:"Ã—"})]}),e.jsx("div",{className:"rate-options",children:a.map(c=>e.jsxs("button",{className:`rate-option ${c===s?"current":""}`,onClick:()=>c!==s&&r&&t(c),disabled:c===s||!r,children:[(c*100).toFixed(0),"%",c===s&&e.jsx("span",{className:"current-label",children:"å½“å‰"})]},c))}),e.jsx("div",{className:"selector-note",children:"âš ï¸ æ¯å›åˆåªèƒ½æ›´æ”¹ä¸€æ¬¡ç¨ç‡"})]})}function Na(){const[s,a]=n.useState([]),[r,t]=n.useState([]),[d,c]=n.useState(!0),[o,f]=n.useState(null),[l,k]=n.useState({}),[m,h]=n.useState(!1),[v,y]=n.useState(null),[j,g]=n.useState({});n.useEffect(()=>{C()},[]);const C=async()=>{c(!0),f(null);try{const[u,p]=await Promise.all([os(l),Le()]);u.success&&u.data?a(u.data):f(u.error||"è·å–éƒ¡å›½æ•°æ®å¤±è´¥"),p.success&&p.data&&t(p.data)}catch{f("ç½‘ç»œé”™è¯¯")}finally{c(!1)}},b=()=>{C()},i=()=>{k({}),C()},E=()=>{y(null),g({provinceName:"",districtName:"",castleName:"",castleLevel:1,baseKokudaka:0}),h(!0)},I=u=>{y(u),g({...u}),h(!0)},N=async u=>{if(!confirm(`ç¡®å®šè¦åˆ é™¤ã€Œ${u.districtName}ã€å—ï¼Ÿ`))return;const p=await ms(u.id);p.success?C():alert(p.error||"åˆ é™¤å¤±è´¥")},D=async()=>{if(!j.provinceName||!j.districtName||!j.castleName){alert("è¯·å¡«å†™å¿…å¡«é¡¹");return}let u;v?u=await us(v.id,j):u=await ds(j),u.success?(h(!1),C()):alert(u.error||"ä¿å­˜å¤±è´¥")},q=[{key:"provinceName",title:"ä»¤åˆ¶å›½",width:"10%"},{key:"districtName",title:"éƒ¡å",width:"10%"},{key:"castleName",title:"åŸæ± ",width:"10%"},{key:"castleLevel",title:"ç­‰çº§",width:"6%"},{key:"baseKokudaka",title:"çŸ³é«˜",width:"10%",render:u=>u.baseKokudaka.toLocaleString()},{key:"specialProducts",title:"ç‰¹äº§",width:"15%",render:u=>[u.specialProduct1,u.specialProduct2,u.specialProduct3].filter(Boolean).join(", ")||"-"},{key:"factionId",title:"æ‰€å±åŠ¿åŠ›",width:"12%",render:u=>{const p=r.find(S=>S.id===u.factionId);return(p==null?void 0:p.name)||"-"}},{key:"actions",title:"æ“ä½œ",width:"12%",render:u=>e.jsxs("div",{className:"action-cell",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>I(u),children:"ç¼–è¾‘"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>N(u),children:"åˆ é™¤"})]})}];return d?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):e.jsxs("div",{className:"management-section",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"éƒ¡å›½æ•°æ®ç®¡ç†"}),e.jsx("div",{className:"management-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:E,children:"æ–°å¢éƒ¡å›½"})})]}),e.jsxs("div",{className:"management-body",children:[e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"ä»¤åˆ¶å›½"}),e.jsx("input",{type:"text",value:l.provinceName||"",onChange:u=>k({...l,provinceName:u.target.value}),placeholder:"æœç´¢ä»¤åˆ¶å›½"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"éƒ¡å"}),e.jsx("input",{type:"text",value:l.districtName||"",onChange:u=>k({...l,districtName:u.target.value}),placeholder:"æœç´¢éƒ¡å"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"æ‰€å±åŠ¿åŠ›"}),e.jsxs("select",{value:l.factionId??"",onChange:u=>k({...l,factionId:u.target.value||void 0}),children:[e.jsx("option",{value:"",children:"å…¨éƒ¨"}),e.jsx("option",{value:"",children:"æ— ä¸»é¢†åœ°"}),r.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]})]}),e.jsxs("div",{className:"filter-actions",children:[e.jsx("button",{className:"btn btn-primary",onClick:b,children:"æœç´¢"}),e.jsx("button",{className:"btn btn-secondary",onClick:i,children:"é‡ç½®"})]})]}),o?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:o}),e.jsx("button",{className:"btn btn-primary",onClick:C,children:"é‡è¯•"})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"æš‚æ— éƒ¡å›½æ•°æ®"}),e.jsx("button",{className:"btn btn-primary",onClick:E,children:"æ–°å¢éƒ¡å›½"})]}):e.jsx(se,{columns:q,data:s,rowKey:u=>u.id,maxRows:10})]}),m&&e.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:e.jsxs("div",{className:"modal-content",onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:v?"ç¼–è¾‘éƒ¡å›½":"æ–°å¢éƒ¡å›½"}),e.jsx("button",{className:"modal-close",onClick:()=>h(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ä»¤åˆ¶å›½ *"}),e.jsx("input",{type:"text",value:j.provinceName||"",onChange:u=>g({...j,provinceName:u.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"éƒ¡å *"}),e.jsx("input",{type:"text",value:j.districtName||"",onChange:u=>g({...j,districtName:u.target.value})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŸæ± åç§° *"}),e.jsx("input",{type:"text",value:j.castleName||"",onChange:u=>g({...j,castleName:u.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŸæ± ç­‰çº§ (1-7)"}),e.jsx("input",{type:"number",min:"1",max:"7",value:j.castleLevel||1,onChange:u=>g({...j,castleLevel:Number(u.target.value)})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŸºç¡€çŸ³é«˜"}),e.jsx("input",{type:"number",min:"0",value:j.baseKokudaka||0,onChange:u=>g({...j,baseKokudaka:Number(u.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ä»¤åˆ¶å›½æ€»çŸ³é«˜"}),e.jsx("input",{type:"number",min:"0",value:j.provinceTotalKokudaka||0,onChange:u=>g({...j,provinceTotalKokudaka:Number(u.target.value)||void 0}),placeholder:"ç”¨äºè®¡ç®—æ•´åˆå¥–åŠ±é—¨æ§›"})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ‰€å±åŠ¿åŠ›"}),e.jsxs("select",{value:j.factionId||"",onChange:u=>g({...j,factionId:u.target.value||void 0}),children:[e.jsx("option",{value:"",children:"æ— "}),r.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]})]})}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç‰¹äº§1"}),e.jsx("input",{type:"text",value:j.specialProduct1||"",onChange:u=>g({...j,specialProduct1:u.target.value||void 0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç‰¹äº§2"}),e.jsx("input",{type:"text",value:j.specialProduct2||"",onChange:u=>g({...j,specialProduct2:u.target.value||void 0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç‰¹äº§3"}),e.jsx("input",{type:"text",value:j.specialProduct3||"",onChange:u=>g({...j,specialProduct3:u.target.value||void 0})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¯å‘å±•ç‰¹äº§"}),e.jsx("input",{type:"text",value:j.developableProduct||"",onChange:u=>g({...j,developableProduct:u.target.value||void 0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æè¿°"}),e.jsx("textarea",{value:j.description||"",onChange:u=>g({...j,description:u.target.value||void 0})})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>h(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:D,children:"ä¿å­˜"})]})]})})]})}function ga(){const[s,a]=n.useState([]),[r,t]=n.useState(!0),[d,c]=n.useState(null),[o,f]=n.useState(!1),[l,k]=n.useState(null),[m,h]=n.useState({name:"",lordName:"",code:"",taxRate:.6}),[v,y]=n.useState(!1),[j,g]=n.useState(null),[C,b]=n.useState("");n.useEffect(()=>{i()},[]);const i=async()=>{t(!0),c(null);try{const S=await De();S.success&&S.data?a(S.data):c(S.error||"è·å–åŠ¿åŠ›æ•°æ®å¤±è´¥")}catch{c("ç½‘ç»œé”™è¯¯")}finally{t(!1)}},E=()=>{k(null),h({name:"",lordName:"",code:"",taxRate:.6}),f(!0)},I=S=>{k(S),h({name:S.name,lordName:S.lordName,code:S.code,taxRate:.6}),f(!0)},N=S=>{g(S),b(S.code),y(!0)},D=async S=>{if(!confirm(`ç¡®å®šè¦åˆ é™¤åŠ¿åŠ›ã€Œ${S.name}ã€å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`))return;const V=await ps(S.id);V.success?i():alert(V.error||"åˆ é™¤å¤±è´¥")},q=async()=>{if(!m.name||!m.lordName||!m.code){alert("è¯·å¡«å†™å¿…å¡«é¡¹");return}let S;l?S=await Fe(l.id,{name:m.name,lordName:m.lordName}):S=await xs(m),S.success?(f(!1),i()):alert(S.error||"ä¿å­˜å¤±è´¥")},u=async()=>{if(!j||!C)return;const S=await js(j.id,C);S.success?(y(!1),i()):alert(S.error||"æ›´æ–°ä»£ç å¤±è´¥")},p=[{key:"name",title:"åŠ¿åŠ›åç§°",width:"25%"},{key:"lordName",title:"å®¶ä¸»å§“å",width:"20%"},{key:"code",title:"ç™»å½•ä»£ç ",width:"25%",render:S=>e.jsx("span",{style:{fontFamily:"monospace"},children:S.code})},{key:"actions",title:"æ“ä½œ",width:"30%",render:S=>e.jsxs("div",{className:"action-cell",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>I(S),children:"ç¼–è¾‘"}),e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>N(S),children:"æ”¹ä»£ç "}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>D(S),children:"åˆ é™¤"})]})}];return r?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):e.jsxs("div",{className:"management-section",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"åŠ¿åŠ›ä»£ç ç®¡ç†"}),e.jsx("div",{className:"management-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:E,children:"æ–°å¢åŠ¿åŠ›"})})]}),e.jsx("div",{className:"management-body",children:d?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:d}),e.jsx("button",{className:"btn btn-primary",onClick:i,children:"é‡è¯•"})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"æš‚æ— åŠ¿åŠ›æ•°æ®"}),e.jsx("button",{className:"btn btn-primary",onClick:E,children:"æ–°å¢åŠ¿åŠ›"})]}):e.jsx(se,{columns:p,data:s,rowKey:S=>S.id,maxRows:10})}),o&&e.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:e.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:l?"ç¼–è¾‘åŠ¿åŠ›":"æ–°å¢åŠ¿åŠ›"}),e.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŠ¿åŠ›åç§° *"}),e.jsx("input",{type:"text",value:m.name,onChange:S=>h({...m,name:S.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å®¶ä¸»å§“å *"}),e.jsx("input",{type:"text",value:m.lordName,onChange:S=>h({...m,lordName:S.target.value})})]}),!l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç™»å½•ä»£ç  *"}),e.jsx("input",{type:"text",value:m.code,onChange:S=>h({...m,code:S.target.value})}),e.jsx("div",{className:"form-hint",children:"ç©å®¶ä½¿ç”¨æ­¤ä»£ç ç™»å½•"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç¨ç‡"}),e.jsxs("select",{value:m.taxRate,onChange:S=>h({...m,taxRate:Number(S.target.value)}),children:[e.jsx("option",{value:.4,children:"40%"}),e.jsx("option",{value:.6,children:"60%"}),e.jsx("option",{value:.8,children:"80%"})]})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:q,children:"ä¿å­˜"})]})]})}),v&&j&&e.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:e.jsxs("div",{className:"modal-content",onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"ä¿®æ”¹ç™»å½•ä»£ç "}),e.jsx("button",{className:"modal-close",onClick:()=>y(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:["åŠ¿åŠ›ï¼š",j.name]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ–°ç™»å½•ä»£ç "}),e.jsx("input",{type:"text",value:C,onChange:S=>b(S.target.value)})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>y(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:u,children:"ç¡®è®¤ä¿®æ”¹"})]})]})})]})}function ba({factionId:s,factionName:a,onClose:r}){const[t,d]=n.useState([]),[c,o]=n.useState([]),[f,l]=n.useState(!0),[k,m]=n.useState(null),[h,v]=n.useState(!1),[y,j]=n.useState(null),[g,C]=n.useState({name:"",age:25,type:"warrior",martialValue:1,civilValue:1,factionId:s});n.useEffect(()=>{b(),i()},[s]);const b=async()=>{l(!0),m(null);try{const p=await _s(s);p.success&&p.data?d(p.data):m(p.error||"è·å–æ­¦å£«æ•°æ®å¤±è´¥")}catch{m("ç½‘ç»œé”™è¯¯")}finally{l(!1)}},i=async()=>{try{const p=await Le();p.success&&p.data&&o(p.data)}catch{}},E=()=>{j(null),C({name:"",age:25,type:"warrior",martialValue:1,civilValue:1,factionId:s}),v(!0)},I=p=>{j(p),C({name:p.name,age:p.age||25,type:p.type,martialValue:p.martialValue,civilValue:p.civilValue,factionId:p.factionId}),v(!0)},N=async()=>{if(!g.name.trim()){alert("è¯·è¾“å…¥æ­¦å£«å§“å");return}try{let p;y?p=await Vs(y.id,g):p=await Js(g),p.success?(v(!1),j(null),b()):alert(p.error||"ä¿å­˜å¤±è´¥")}catch{alert("ç½‘ç»œé”™è¯¯")}},D=async p=>{if(confirm(`ç¡®å®šè¦åˆ é™¤æ­¦å£«ã€Œ${p.name}ã€å—ï¼Ÿ`))try{const S=await Us(p.id);S.success?b():alert(S.error||"åˆ é™¤å¤±è´¥")}catch{alert("ç½‘ç»œé”™è¯¯")}},q=()=>{v(!1),j(null)},u=p=>p===2?"action-points-full":p===1?"action-points-partial":"action-points-empty";return e.jsx("div",{className:"modal-overlay",onClick:r,children:e.jsxs("div",{className:"modal-content modal-large samurai-management-dialog",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["æ­¦å£«ç®¡ç†ï¼š",a]}),e.jsx("button",{className:"modal-close",onClick:r,children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:f?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):k?e.jsxs("div",{className:"error-container",children:[e.jsx("p",{children:k}),e.jsx("button",{onClick:b,children:"é‡è¯•"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"samurai-header",children:[e.jsxs("h4",{children:["æ­¦å£«åˆ—è¡¨ (",t.length,"äºº)"]}),e.jsx("button",{className:"btn btn-primary",onClick:E,children:"æ·»åŠ æ­¦å£«"})]}),t.length===0?e.jsx("div",{className:"empty-state",children:"æš‚æ— æ­¦å£«"}):e.jsx("div",{className:"samurai-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"å§“å"}),e.jsx("th",{children:"å¹´é¾„"}),e.jsx("th",{children:"ç±»å‹"}),e.jsx("th",{children:"æ­¦åŠŸ"}),e.jsx("th",{children:"æ–‡æ²»"}),e.jsx("th",{children:"çŠ¶æ€"}),e.jsx("th",{children:"è¡ŒåŠ¨åŠ›"}),e.jsx("th",{children:"æ“ä½œ"})]})}),e.jsx("tbody",{children:t.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.name}),e.jsx("td",{children:p.age||"-"}),e.jsx("td",{children:p.type==="warrior"?"æ­¦å°†":"æ–‡å®˜"}),e.jsx("td",{children:p.martialValue}),e.jsx("td",{children:p.civilValue}),e.jsx("td",{children:e.jsx("span",{className:p.isIdle?"status-idle":"status-busy",children:p.isIdle?"é—²ç½®":"å¿™ç¢Œ"})}),e.jsx("td",{children:e.jsx("span",{className:u(p.actionPoints),children:p.actionPoints})}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>I(p),children:"ç¼–è¾‘"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>D(p),children:"åˆ é™¤"})]})]},p.id))})]})})]})}),h&&e.jsx("div",{className:"form-overlay",children:e.jsxs("div",{className:"form-content",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("h4",{children:y?"ç¼–è¾‘æ­¦å£«":"æ·»åŠ æ­¦å£«"}),e.jsx("button",{className:"form-close",onClick:q,children:"Ã—"})]}),e.jsx("div",{className:"form-body",children:e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å§“å *"}),e.jsx("input",{type:"text",value:g.name,onChange:p=>C({...g,name:p.target.value}),placeholder:"è¯·è¾“å…¥æ­¦å£«å§“å"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¹´é¾„"}),e.jsx("input",{type:"number",min:"15",max:"80",value:g.age,onChange:p=>C({...g,age:Number(p.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç±»å‹"}),e.jsxs("select",{value:g.type,onChange:p=>C({...g,type:p.target.value}),children:[e.jsx("option",{value:"warrior",children:"æ­¦å°†"}),e.jsx("option",{value:"strategist",children:"æ–‡å®˜"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ­¦åŠŸ"}),e.jsx("input",{type:"number",min:"1",max:"10",value:g.martialValue,onChange:p=>C({...g,martialValue:Number(p.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ–‡æ²»"}),e.jsx("input",{type:"number",min:"1",max:"10",value:g.civilValue,onChange:p=>C({...g,civilValue:Number(p.target.value)})})]}),y&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"è½¬ç§»åˆ°åŠ¿åŠ›"}),e.jsx("select",{value:g.factionId,onChange:p=>C({...g,factionId:p.target.value}),children:c.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))})]})]})}),e.jsxs("div",{className:"form-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:q,children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:N,children:"ä¿å­˜"})]})]})})]})})}function ya(){const[s,a]=n.useState([]),[r,t]=n.useState(!0),[d,c]=n.useState(null),[o,f]=n.useState(null),[l,k]=n.useState({}),[m,h]=n.useState(null);n.useEffect(()=>{v()},[]);const v=async()=>{t(!0),c(null);try{const i=await hs();i.success&&i.data?a(i.data):c(i.error||"è·å–åŠ¿åŠ›æ•°æ®å¤±è´¥")}catch{c("ç½‘ç»œé”™è¯¯")}finally{t(!1)}},y=i=>{f(i),k({...i})},j=async()=>{if(!o)return;const i=await Fe(o.id,{name:l.name,lordName:l.lordName,taxRate:l.taxRate,treasury:l.treasury,idleSoldiers:l.idleSoldiers,rifles:l.rifles,horses:l.horses,cannons:l.cannons,agriculturePoints:l.agriculturePoints,commercePoints:l.commercePoints,navyPoints:l.navyPoints,armamentPoints:l.armamentPoints,industryKokudaka:l.industryKokudaka});i.success?(f(null),v()):alert(i.error||"ä¿å­˜å¤±è´¥")},g=()=>{f(null),k({})},C=i=>{h({factionId:i.id,factionName:i.name})},b=()=>{h(null),v()};return r?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):d?e.jsxs("div",{className:"error-container",children:[e.jsx("p",{children:d}),e.jsx("button",{onClick:v,children:"é‡è¯•"})]}):e.jsxs("div",{className:"faction-full-management",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"åŠ¿åŠ›å®Œæ•´ç®¡ç†"}),e.jsx("button",{className:"btn btn-secondary",onClick:v,children:"åˆ·æ–°"})]}),s.length===0?e.jsx("div",{className:"empty-state",children:"æš‚æ— åŠ¿åŠ›æ•°æ®"}):e.jsx("div",{className:"faction-cards",children:s.map(i=>e.jsxs("div",{className:"faction-card",children:[e.jsxs("div",{className:"faction-card-header",children:[e.jsx("h3",{children:i.name}),e.jsxs("div",{className:"faction-actions",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>C(i),children:"ç¼–è¾‘æ­¦å£«"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>y(i),children:"ç¼–è¾‘"})]})]}),e.jsxs("div",{className:"faction-row",children:[e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"å®¶ä¸»å§“å"}),e.jsx("span",{children:i.lordName})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"ç™»å½•ä»£ç "}),e.jsx("span",{className:"code",children:i.code})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"ç¨ç‡"}),e.jsxs("span",{children:[(i.taxRate*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"é‡‘åº“"}),e.jsxs("span",{children:[i.treasury.toLocaleString(),"çŸ³"]})]})]}),e.jsxs("div",{className:"faction-row",children:[e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"é—²ç½®å£«å…µ"}),e.jsxs("span",{children:[i.idleSoldiers.toLocaleString(),"äºº"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"é“ç‚®"}),e.jsxs("span",{children:[i.rifles.toLocaleString(),"æŒº"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"æˆ˜é©¬"}),e.jsxs("span",{children:[i.horses.toLocaleString(),"åŒ¹"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"å¤§ç­’"}),e.jsxs("span",{children:[i.cannons.toLocaleString(),"é—¨"]})]})]}),e.jsxs("div",{className:"faction-row",children:[e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"å†œä¸šç‚¹æ•°"}),e.jsx("span",{children:i.agriculturePoints})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"å•†ä¸šç‚¹æ•°"}),e.jsx("span",{children:i.commercePoints})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"æ°´å†›ç‚¹æ•°"}),e.jsx("span",{children:i.navyPoints})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"æ­¦å¤‡ç‚¹æ•°"}),e.jsx("span",{children:i.armamentPoints})]})]}),e.jsxs("div",{className:"faction-row",children:[e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"äº§ä¸šçŸ³é«˜"}),e.jsxs("span",{children:[(i.industryKokudaka/1e4).toFixed(2),"ä¸‡çŸ³"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"ä¸Šçº§æ­¦å£«æ•°"}),e.jsxs("span",{children:[i.samuraiCount,"äºº"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"è¡¨é¢çŸ³é«˜"}),e.jsxs("span",{children:[(i.surfaceKokudaka/1e4).toFixed(2),"ä¸‡çŸ³"]})]}),e.jsxs("div",{className:"faction-field",children:[e.jsx("label",{children:"æ€»å…µåŠ›"}),e.jsxs("span",{children:[i.totalSoldiers.toLocaleString(),"äºº"]})]})]}),i.buffs&&i.buffs.length>0&&e.jsxs("div",{className:"faction-buffs",children:[e.jsx("label",{children:"åŠ æˆæ˜ç»†"}),e.jsx("div",{className:"buffs-list",children:i.buffs.map((E,I)=>e.jsxs("span",{className:"buff-tag",children:[E.name,": ",E.effect]},I))})]})]},i.id))}),o&&e.jsx("div",{className:"modal-overlay",onClick:g,children:e.jsxs("div",{className:"modal-content modal-large",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{children:["ç¼–è¾‘åŠ¿åŠ›ï¼š",o.name]}),e.jsx("button",{className:"modal-close",onClick:g,children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"edit-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŠ¿åŠ›åç§°"}),e.jsx("input",{type:"text",value:l.name||"",onChange:i=>k({...l,name:i.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å®¶ä¸»å§“å"}),e.jsx("input",{type:"text",value:l.lordName||"",onChange:i=>k({...l,lordName:i.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç¨ç‡"}),e.jsxs("select",{value:l.taxRate||.6,onChange:i=>k({...l,taxRate:Number(i.target.value)}),children:[e.jsx("option",{value:.4,children:"40%"}),e.jsx("option",{value:.6,children:"60%"}),e.jsx("option",{value:.8,children:"80%"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"é‡‘åº“ï¼ˆçŸ³ï¼‰"}),e.jsx("input",{type:"number",value:l.treasury||0,onChange:i=>k({...l,treasury:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"é—²ç½®å£«å…µ"}),e.jsx("input",{type:"number",value:l.idleSoldiers||0,onChange:i=>k({...l,idleSoldiers:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"é“ç‚®"}),e.jsx("input",{type:"number",value:l.rifles||0,onChange:i=>k({...l,rifles:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æˆ˜é©¬"}),e.jsx("input",{type:"number",value:l.horses||0,onChange:i=>k({...l,horses:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¤§ç­’"}),e.jsx("input",{type:"number",value:l.cannons||0,onChange:i=>k({...l,cannons:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å†œä¸šç‚¹æ•°"}),e.jsx("input",{type:"number",value:l.agriculturePoints||0,onChange:i=>k({...l,agriculturePoints:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å•†ä¸šç‚¹æ•°"}),e.jsx("input",{type:"number",value:l.commercePoints||0,onChange:i=>k({...l,commercePoints:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ°´å†›ç‚¹æ•°"}),e.jsx("input",{type:"number",value:l.navyPoints||0,onChange:i=>k({...l,navyPoints:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æ­¦å¤‡ç‚¹æ•°"}),e.jsx("input",{type:"number",value:l.armamentPoints||0,onChange:i=>k({...l,armamentPoints:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"äº§ä¸šçŸ³é«˜"}),e.jsx("input",{type:"number",value:l.industryKokudaka||0,onChange:i=>k({...l,industryKokudaka:Number(i.target.value)})})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:g,children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:j,children:"ä¿å­˜"})]})]})}),m&&e.jsx(ba,{factionId:m.factionId,factionName:m.factionName,onClose:b})]})}function Ca(){const[s,a]=n.useState([]),[r,t]=n.useState(!0),[d,c]=n.useState(null),[o,f]=n.useState(!1),[l,k]=n.useState(null),[m,h]=n.useState({name:"",soldierCount:0,rifles:0,horses:0,cannons:0});n.useEffect(()=>{v()},[]);const v=async()=>{t(!0),c(null);try{const b=await fs();b.success&&b.data?a(b.data):c(b.error||"è·å–å†›å›¢æ•°æ®å¤±è´¥")}catch{c("ç½‘ç»œé”™è¯¯")}finally{t(!1)}},y=b=>{k(b),h({name:b.name,soldierCount:b.soldierCount,rifles:b.rifles,horses:b.horses,cannons:b.cannons}),f(!0)},j=async b=>{if(!confirm(`ç¡®å®šè¦åˆ é™¤å†›å›¢ã€Œ${b.name}ã€å—ï¼Ÿèµ„æºå°†è¿”è¿˜åˆ°åŠ¿åŠ›åº“å­˜ã€‚`))return;const i=await Ns(b.id);i.success?v():alert(i.error||"åˆ é™¤å¤±è´¥")},g=async()=>{if(!l)return;if(!/^[\u4e00-\u9fa5]{1,8}$/.test(m.name)){alert("å†›å›¢åç§°å¿…é¡»ä¸º1-8ä¸ªç®€ä½“ä¸­æ–‡å­—ç¬¦");return}const i=await vs(l.id,m);i.success?(f(!1),v()):alert(i.error||"æ›´æ–°å¤±è´¥")},C=[{key:"factionName",title:"æ‰€å±åŠ¿åŠ›",width:"12%"},{key:"name",title:"å†›å›¢å",width:"12%"},{key:"commanderName",title:"å°†é¢†",width:"10%"},{key:"soldierCount",title:"äººæ•°",width:"8%",render:b=>b.soldierCount.toLocaleString()},{key:"rifles",title:"é“ç‚®",width:"8%",render:b=>b.rifles.toLocaleString()},{key:"horses",title:"æˆ˜é©¬",width:"8%",render:b=>b.horses.toLocaleString()},{key:"cannons",title:"å¤§ç­’",width:"8%",render:b=>b.cannons.toLocaleString()},{key:"locationName",title:"ä½ç½®",width:"12%"},{key:"actions",title:"æ“ä½œ",width:"15%",render:b=>e.jsxs("div",{className:"action-cell",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>y(b),children:"ç¼–è¾‘"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>j(b),children:"åˆ é™¤"})]})}];return r?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):e.jsxs("div",{className:"management-section",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"å…¨å†›å›¢ä¸€è§ˆ"}),e.jsx("div",{className:"management-actions",children:e.jsx("button",{className:"btn btn-secondary",onClick:v,children:"åˆ·æ–°"})})]}),e.jsx("div",{className:"management-body",children:d?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:d}),e.jsx("button",{className:"btn btn-primary",onClick:v,children:"é‡è¯•"})]}):s.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"æš‚æ— å†›å›¢æ•°æ®"})}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{marginBottom:"16px",color:"#666"},children:["å…± ",s.length," ä¸ªå†›å›¢"]}),e.jsx(se,{columns:C,data:s,rowKey:b=>b.id,maxRows:10})]})}),o&&l&&e.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:e.jsxs("div",{className:"modal-content",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:"ç¼–è¾‘å†›å›¢"}),e.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{style:{marginBottom:"16px",color:"#666"},children:["æ‰€å±åŠ¿åŠ›ï¼š",l.factionName," | å°†é¢†ï¼š",l.commanderName]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å†›å›¢åç§°"}),e.jsx("input",{type:"text",value:m.name,onChange:b=>h({...m,name:b.target.value})}),e.jsx("div",{className:"form-hint",children:"1-8ä¸ªç®€ä½“ä¸­æ–‡å­—ç¬¦"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"äººæ•°"}),e.jsx("input",{type:"number",min:"0",value:m.soldierCount,onChange:b=>h({...m,soldierCount:Number(b.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"é“ç‚®"}),e.jsx("input",{type:"number",min:"0",value:m.rifles,onChange:b=>h({...m,rifles:Number(b.target.value)})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"æˆ˜é©¬"}),e.jsx("input",{type:"number",min:"0",value:m.horses,onChange:b=>h({...m,horses:Number(b.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¤§ç­’"}),e.jsx("input",{type:"number",min:"0",value:m.cannons,onChange:b=>h({...m,cannons:Number(b.target.value)})})]})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:g,children:"ä¿å­˜"})]})]})})]})}function ka(){const[s,a]=n.useState([]),[r,t]=n.useState(!0),[d,c]=n.useState(null),[o,f]=n.useState(!1),[l,k]=n.useState(null),[m,h]=n.useState({name:"",annualKokudaka:0,annualHorses:0,soldierCapacityBonus:0,kokudakaBonus:0,otherEffects:""});n.useEffect(()=>{v()},[]);const v=async()=>{t(!0),c(null);try{const i=await gs();i.success&&i.data?a(i.data):c(i.error||"è·å–ç‰¹äº§æ•°æ®å¤±è´¥")}catch{c("ç½‘ç»œé”™è¯¯")}finally{t(!1)}},y=()=>{k(null),h({name:"",annualKokudaka:0,annualHorses:0,soldierCapacityBonus:0,kokudakaBonus:0,otherEffects:""}),f(!0)},j=i=>{k(i),h({...i}),f(!0)},g=async i=>{if(!confirm(`ç¡®å®šè¦åˆ é™¤ç‰¹äº§ã€Œ${i.name}ã€å—ï¼Ÿ`))return;const E=await Cs(i.name);E.success?v():alert(E.error||"åˆ é™¤å¤±è´¥")},C=async()=>{if(!m.name){alert("è¯·å¡«å†™ç‰¹äº§åç§°");return}let i;l?i=await ys(l.name,m):i=await bs(m),i.success?(f(!1),v()):alert(i.error||"ä¿å­˜å¤±è´¥")},b=[{key:"name",title:"ç‰¹äº§åç§°",width:"15%"},{key:"annualKokudaka",title:"å¹´äº§çŸ³é«˜",width:"12%",render:i=>i.annualKokudaka.toLocaleString()},{key:"annualHorses",title:"å¹´äº§æˆ˜é©¬",width:"12%",render:i=>i.annualHorses.toLocaleString()},{key:"soldierCapacityBonus",title:"å…µåŠ›åŠ æˆ",width:"12%",render:i=>i.soldierCapacityBonus?`+${i.soldierCapacityBonus}`:"-"},{key:"kokudakaBonus",title:"çŸ³é«˜åŠ æˆ",width:"12%",render:i=>i.kokudakaBonus?`+${(i.kokudakaBonus*100).toFixed(0)}%`:"-"},{key:"otherEffects",title:"å…¶ä»–æ•ˆæœ",width:"20%",render:i=>i.otherEffects||"-"},{key:"actions",title:"æ“ä½œ",width:"15%",render:i=>e.jsxs("div",{className:"action-cell",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>j(i),children:"ç¼–è¾‘"}),e.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>g(i),children:"åˆ é™¤"})]})}];return r?e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):e.jsxs("div",{className:"management-section",children:[e.jsxs("div",{className:"management-header",children:[e.jsx("h2",{children:"ç‰¹äº§ç³»ç»Ÿé…ç½®"}),e.jsx("div",{className:"management-actions",children:e.jsx("button",{className:"btn btn-primary",onClick:y,children:"æ–°å¢ç‰¹äº§"})})]}),e.jsx("div",{className:"management-body",children:d?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:d}),e.jsx("button",{className:"btn btn-primary",onClick:v,children:"é‡è¯•"})]}):s.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"æš‚æ— ç‰¹äº§æ•°æ®"}),e.jsx("button",{className:"btn btn-primary",onClick:y,children:"æ–°å¢ç‰¹äº§"})]}):e.jsx(se,{columns:b,data:s,rowKey:i=>i.name,maxRows:10})}),o&&e.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:e.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:l?"ç¼–è¾‘ç‰¹äº§":"æ–°å¢ç‰¹äº§"}),e.jsx("button",{className:"modal-close",onClick:()=>f(!1),children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ç‰¹äº§åç§° *"}),e.jsx("input",{type:"text",value:m.name,onChange:i=>h({...m,name:i.target.value}),disabled:!!l}),l&&e.jsx("div",{className:"form-hint",children:"ç‰¹äº§åç§°ä¸å¯ä¿®æ”¹"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¹´äº§çŸ³é«˜"}),e.jsx("input",{type:"number",min:"0",value:m.annualKokudaka,onChange:i=>h({...m,annualKokudaka:Number(i.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¹´äº§æˆ˜é©¬"}),e.jsx("input",{type:"number",min:"0",value:m.annualHorses,onChange:i=>h({...m,annualHorses:Number(i.target.value)})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å…µåŠ›åŠ æˆ"}),e.jsx("input",{type:"number",min:"0",value:m.soldierCapacityBonus,onChange:i=>h({...m,soldierCapacityBonus:Number(i.target.value)})}),e.jsx("div",{className:"form-hint",children:"å¢åŠ å¯æ‹›å‹Ÿå£«å…µä¸Šé™"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"çŸ³é«˜åŠ æˆ (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",step:"1",value:m.kokudakaBonus*100,onChange:i=>h({...m,kokudakaBonus:Number(i.target.value)/100})}),e.jsx("div",{className:"form-hint",children:"ç™¾åˆ†æ¯”åŠ æˆ"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å…¶ä»–æ•ˆæœ"}),e.jsx("textarea",{value:m.otherEffects,onChange:i=>h({...m,otherEffects:i.target.value}),placeholder:"æè¿°å…¶ä»–ç‰¹æ®Šæ•ˆæœ..."})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>f(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"btn btn-primary",onClick:C,children:"ä¿å­˜"})]})]})})]})}function Sa(){const[s,a]=n.useState("control"),[r,t]=n.useState(!1),[d,c]=n.useState(null),[o,f]=n.useState(null),[l,k]=n.useState([]),[m,h]=n.useState([]),[v,y]=n.useState({}),[j,g]=n.useState([]),[C,b]=n.useState(!1),[i,E]=n.useState(!1),[I,N]=n.useState(null),[D,q]=n.useState(!1),[u,p]=n.useState(!1),[S,V]=n.useState(null),[_,U]=n.useState({year:1,factionId:"",content:"",shouldCalculate:!1}),J=n.useCallback(async()=>{const x=await ks();x.success&&x.data&&(f(x.data),U(K=>({...K,year:x.data.currentYear})))},[]),G=n.useCallback(async()=>{const x=await De();x.success&&x.data&&h(x.data)},[]),T=n.useCallback(async()=>{const x=await Ls(v);x.success&&x.data&&k(x.data)},[v]),F=n.useCallback(async()=>{const x=await Ts(20);x.success&&x.data&&g(x.data)},[]);n.useEffect(()=>{J(),G()},[J,G]),n.useEffect(()=>{s==="accounting"?T():s==="operations"&&F()},[s,T,F]);const B=async()=>{t(!0),c(null);try{const x=await Ss();x.success&&x.data?(N(x.data),b(!1),E(!0),await J()):c(x.error||"ç»“ç®—å¤±è´¥")}catch{c("æ“ä½œå¤±è´¥")}finally{t(!1)}},H=async()=>{t(!0),c(null);try{const x=o!=null&&o.isLocked?await Is():await ws();x.success?await J():c(x.error||"æ“ä½œå¤±è´¥")}catch{c("æ“ä½œå¤±è´¥")}finally{t(!1)}},R=async()=>{if(!_.factionId||!_.content.trim()){c("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");return}t(!0),c(null);try{const x=await Ps(_);x.success?(q(!1),U({year:(o==null?void 0:o.currentYear)||1,factionId:"",content:"",shouldCalculate:!1}),await T()):c(x.error||"æ·»åŠ å¤±è´¥")}catch{c("æ“ä½œå¤±è´¥")}finally{t(!1)}},O=async x=>{if(confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æ—¥å¿—å—ï¼Ÿ")){t(!0);try{const K=await Es(x);K.success?await T():c(K.error||"åˆ é™¤å¤±è´¥")}catch{c("æ“ä½œå¤±è´¥")}finally{t(!1)}}},ne=async()=>{if(S){t(!0),c(null);try{const x=await $s(S.id);x.success?(p(!1),V(null),await J(),await F(),alert("æ•°æ®å·²å›æº¯")):c(x.error||"å›æº¯å¤±è´¥")}catch{c("æ“ä½œå¤±è´¥")}finally{t(!1)}}},Z=x=>new Date(x).toLocaleString("zh-CN"),Q=x=>({advance_year:"å¹´åº¦ç»“ç®—",lock_game:"é”å®šæ¸¸æˆ",unlock_game:"è§£é”æ¸¸æˆ",rollback:"æ•°æ®å›æº¯",create_legion:"åˆ›å»ºå†›å›¢",disband_legion:"è§£æ•£å†›å›¢",recruit:"æ‹›å‹Ÿå£«å…µ",investment:"æ‰§è¡ŒæŠ•èµ„"})[x]||x,ie=[{key:"control",label:"è¿›ç¨‹æ§åˆ¶"},{key:"accounting",label:"è®°è´¦æ¨æ¼”"},{key:"operations",label:"æ“ä½œè®°å½•"}];return e.jsxs("div",{className:"game-progress-control",children:[e.jsx("nav",{className:"progress-tabs",children:ie.map(x=>e.jsx("button",{className:`tab-btn ${s===x.key?"active":""}`,onClick:()=>a(x.key),children:x.label},x.key))}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsxs("div",{className:"progress-content",children:[s==="control"&&e.jsxs("div",{className:"control-panel",children:[e.jsxs("div",{className:"status-card",children:[e.jsx("h3",{children:"æ¸¸æˆçŠ¶æ€"}),o?e.jsxs("div",{className:"status-info",children:[e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"å½“å‰å¹´ä»½"}),e.jsxs("span",{className:"value",children:["ç¬¬ ",o.currentYear," å¹´"]})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"æ¸¸æˆçŠ¶æ€"}),e.jsx("span",{className:`value ${o.isLocked?"locked":"unlocked"}`,children:o.isLocked?"å·²é”å®š":"è¿›è¡Œä¸­"})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"åŠ¿åŠ›æ•°é‡"}),e.jsx("span",{className:"value",children:o.factionCount})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"é¢†åœ°æ•°é‡"}),e.jsx("span",{className:"value",children:o.totalTerritories})]}),e.jsxs("div",{className:"status-item",children:[e.jsx("span",{className:"label",children:"å†›å›¢æ•°é‡"}),e.jsx("span",{className:"value",children:o.totalLegions})]})]}):e.jsx("p",{children:"åŠ è½½ä¸­..."})]}),e.jsxs("div",{className:"control-actions",children:[e.jsx("button",{className:`action-btn ${o!=null&&o.isLocked?"unlock":"lock"}`,onClick:H,disabled:r,children:o!=null&&o.isLocked?"è§£é”æ¸¸æˆ":"é”å®šæ¸¸æˆ"}),e.jsx("button",{className:"action-btn advance",onClick:()=>b(!0),disabled:r||(o==null?void 0:o.isLocked),children:"ä¸‹ä¸€å¹´"})]})]}),s==="accounting"&&e.jsxs("div",{className:"accounting-panel",children:[e.jsx("div",{className:"accounting-header",children:e.jsxs("div",{className:"filter-row",children:[e.jsxs("select",{value:v.year??"",onChange:x=>y(K=>({...K,year:x.target.value?Number(x.target.value):void 0})),children:[e.jsx("option",{value:"",children:"å…¨éƒ¨å¹´ä»½"}),Array.from({length:(o==null?void 0:o.currentYear)||1},(x,K)=>K+1).map(x=>e.jsxs("option",{value:x,children:["ç¬¬ ",x," å¹´"]},x))]}),e.jsxs("select",{value:v.factionId??"",onChange:x=>y(K=>({...K,factionId:x.target.value||void 0})),children:[e.jsx("option",{value:"",children:"å…¨éƒ¨åŠ¿åŠ›"}),m.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]}),e.jsx("button",{className:"add-btn",onClick:()=>q(!0),children:"æ·»åŠ æ—¥å¿—"})]})}),e.jsx("div",{className:"accounting-list",children:l.length===0?e.jsx("p",{className:"empty-message",children:"æš‚æ— è®°è´¦æ—¥å¿—"}):l.map(x=>e.jsxs("div",{className:"log-item",children:[e.jsxs("div",{className:"log-header",children:[e.jsxs("span",{className:"log-year",children:["ç¬¬ ",x.year," å¹´"]}),e.jsx("span",{className:"log-faction",children:x.factionName}),e.jsx("span",{className:`log-calc ${x.shouldCalculate?"yes":"no"}`,children:x.shouldCalculate?"éœ€è®¡ç®—":"ä»…è®°å½•"})]}),e.jsx("div",{className:"log-content",children:x.content}),e.jsxs("div",{className:"log-footer",children:[e.jsx("span",{className:"log-time",children:Z(x.timestamp)}),e.jsx("button",{className:"delete-btn",onClick:()=>O(x.id),children:"åˆ é™¤"})]})]},x.id))})]}),s==="operations"&&e.jsxs("div",{className:"operations-panel",children:[e.jsx("h3",{children:"å¯å›æº¯çš„æ“ä½œè®°å½•ï¼ˆæœ€è¿‘20æ¡ï¼‰"}),e.jsx("div",{className:"operations-list",children:j.length===0?e.jsx("p",{className:"empty-message",children:"æš‚æ— æ“ä½œè®°å½•"}):j.map(x=>e.jsxs("div",{className:`operation-item ${x.hasSnapshot?"has-snapshot":""}`,children:[e.jsxs("div",{className:"op-header",children:[e.jsx("span",{className:"op-action",children:Q(x.action)}),e.jsx("span",{className:"op-user",children:x.userType==="admin"?"ç®¡ç†å‘˜":"ç©å®¶"})]}),e.jsx("div",{className:"op-time",children:Z(x.timestamp)}),x.hasSnapshot&&e.jsx("button",{className:"rollback-btn",onClick:()=>{V(x),p(!0)},children:"è·³è½¬è‡³æ­¤"})]},x.id))})]})]}),C&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsx("h3",{children:"ç¡®è®¤è¿›å…¥ä¸‹ä¸€å¹´ï¼Ÿ"}),e.jsx("p",{children:"å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š"}),e.jsxs("ul",{children:[e.jsx("li",{children:"æ‰£é™¤æ‰€æœ‰åŠ¿åŠ›çš„ç»´æŠ¤è´¹"}),e.jsx("li",{children:"æ ¹æ®è‡ªç„¶å¢é•¿ç‡æ›´æ–°é¢†åœ°çŸ³é«˜"}),e.jsx("li",{children:"é‡ç½®æ‰€æœ‰æ­¦å£«çš„è¡ŒåŠ¨åŠ›"}),e.jsx("li",{children:"åˆ›å»ºæ•°æ®å¿«ç…§"})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:()=>b(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm",onClick:B,disabled:r,children:r?"å¤„ç†ä¸­...":"ç¡®è®¤"})]})]})}),i&&I&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal settlement-modal",children:[e.jsxs("h3",{children:["ç¬¬ ",I.year," å¹´ç»“ç®—å®Œæˆ"]}),e.jsx("div",{className:"settlement-results",children:I.factionSettlements.map(x=>e.jsxs("div",{className:"faction-settlement",children:[e.jsx("h4",{children:x.factionName}),e.jsxs("div",{className:"settlement-detail",children:[e.jsxs("span",{children:["ç»´æŠ¤è´¹ï¼š",x.maintenanceCost.toLocaleString()," çŸ³"]}),e.jsxs("span",{children:["åº“å­˜å˜åŒ–ï¼š",x.previousTreasury.toLocaleString()," â†’ ",x.newTreasury.toLocaleString()]}),e.jsxs("span",{children:["çŸ³é«˜å¢é•¿ï¼š",x.totalKokudakaGrowth>=0?"+":"",x.totalKokudakaGrowth.toLocaleString()]}),e.jsxs("span",{children:["æ­¦å£«é‡ç½®ï¼š",x.samuraisReset," äºº"]})]})]},x.factionId))}),e.jsx("div",{className:"modal-actions",children:e.jsx("button",{onClick:()=>E(!1),children:"å…³é—­"})})]})}),D&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsx("h3",{children:"æ·»åŠ è®°è´¦æ—¥å¿—"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å¹´ä»½"}),e.jsx("select",{value:_.year,onChange:x=>U(K=>({...K,year:Number(x.target.value)})),children:Array.from({length:(o==null?void 0:o.currentYear)||1},(x,K)=>K+1).map(x=>e.jsxs("option",{value:x,children:["ç¬¬ ",x," å¹´"]},x))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"åŠ¿åŠ›"}),e.jsxs("select",{value:_.factionId,onChange:x=>U(K=>({...K,factionId:x.target.value})),children:[e.jsx("option",{value:"",children:"è¯·é€‰æ‹©åŠ¿åŠ›"}),m.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"å†…å®¹"}),e.jsx("textarea",{value:_.content,onChange:x=>U(K=>({...K,content:x.target.value})),placeholder:"è¯·è¾“å…¥è®°è´¦å†…å®¹...",rows:4})]}),e.jsx("div",{className:"form-group checkbox",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:_.shouldCalculate,onChange:x=>U(K=>({...K,shouldCalculate:x.target.checked}))}),"éœ€è¦è®¡ç®—"]})}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:()=>q(!1),children:"å–æ¶ˆ"}),e.jsx("button",{className:"confirm",onClick:R,disabled:r,children:r?"æ·»åŠ ä¸­...":"æ·»åŠ "})]})]})}),u&&S&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal",children:[e.jsx("h3",{children:"ç¡®è®¤å›æº¯æ•°æ®ï¼Ÿ"}),e.jsx("p",{children:"å°†æ•°æ®å›æº¯åˆ°ä»¥ä¸‹æ“ä½œå®Œæˆæ—¶çš„çŠ¶æ€ï¼š"}),e.jsxs("div",{className:"rollback-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"æ“ä½œï¼š"}),Q(S.action)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"æ—¶é—´ï¼š"}),Z(S.timestamp)]})]}),e.jsx("p",{className:"warning",children:"æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œè¯·è°¨æ…æ“ä½œï¼"}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{onClick:()=>{p(!1),V(null)},children:"å–æ¶ˆ"}),e.jsx("button",{className:"danger",onClick:ne,disabled:r,children:r?"å¤„ç†ä¸­...":"ç¡®è®¤å›æº¯"})]})]})})]})}function wa({onImportComplete:s}){const[a,r]=n.useState("territory"),[t,d]=n.useState(null),[c,o]=n.useState(""),[f,l]=n.useState(!0),[k,m]=n.useState(!1),[h,v]=n.useState(null),[y,j]=n.useState(null),[g,C]=n.useState(null);n.useEffect(()=>{b(a)},[a]);const b=async u=>{m(!0),C(null),v(null),j(null);const p=await Os(u);p.success&&p.data?d(p.data):C(p.error||"åŠ è½½æ¨¡æ¿å¤±è´¥"),m(!1)},i=u=>{r(u),o(""),v(null),j(null),C(null)},E=async()=>{if(!c.trim()){C("è¯·è¾“å…¥è¦å¯¼å…¥çš„æ•°æ®");return}m(!0),C(null),j(null);const u=await Rs(a,c);u.success&&u.data?v(u.data):C(u.error||"é¢„è§ˆå¤±è´¥"),m(!1)},I=async()=>{if(!c.trim()){C("è¯·è¾“å…¥è¦å¯¼å…¥çš„æ•°æ®");return}m(!0),C(null);const u=await Ds(a,c,f);u.success&&u.data?(j(u.data),v(null),u.data.imported>0&&(s==null||s())):C(u.error||"å¯¼å…¥å¤±è´¥"),m(!1)},N=u=>{switch(u){case"territory":return"éƒ¡å›½æ•°æ®";case"legion":return"å†›å›¢æ•°æ®";case"faction":return"åŠ¿åŠ›æ•°æ®";case"specialProduct":return"ç‰¹äº§æ•°æ®";default:return u}},D=()=>{if(!h||h.preview.length===0)return null;const u=h.preview,p=Object.keys(u[0]);return e.jsx("div",{className:"preview-table-container",children:e.jsxs("table",{className:"preview-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:p.map(S=>e.jsx("th",{children:q(S)},S))})}),e.jsx("tbody",{children:u.map((S,V)=>e.jsx("tr",{children:p.map(_=>e.jsx("td",{children:String(S[_]??"")},_))},V))})]})})},q=u=>({provinceName:"ä»¤åˆ¶å›½",districtName:"éƒ¡å",castleName:"åŸæ± åç§°",castleLevel:"åŸæ± ç­‰çº§",baseKokudaka:"åŸºç¡€çŸ³é«˜",specialProduct1:"ç‰¹äº§1",specialProduct2:"ç‰¹äº§2",specialProduct3:"ç‰¹äº§3",developableProduct:"å¯å‘å±•ç‰¹äº§",factionName:"åŠ¿åŠ›åç§°",description:"æè¿°",name:"åç§°",commanderName:"å°†é¢†å§“å",soldierCount:"å£«å…µæ•°é‡",rifles:"é“ç‚®",horses:"æˆ˜é©¬",cannons:"å¤§ç­’",locationName:"é©»æ‰ä½ç½®",lordName:"å®¶ä¸»å§“å",code:"ç™»å½•ä»£ç ",taxRate:"ç¨ç‡",treasury:"é‡‘åº“",idleSoldiers:"é—²ç½®å£«å…µ",agriculturePoints:"å†œä¸šç‚¹æ•°",commercePoints:"å•†ä¸šç‚¹æ•°",navyPoints:"æ°´å†›ç‚¹æ•°",armamentPoints:"æ­¦å¤‡ç‚¹æ•°",industryKokudaka:"äº§ä¸šçŸ³é«˜",annualKokudaka:"å¹´äº§çŸ³é«˜",annualHorses:"å¹´äº§æˆ˜é©¬",soldierCapacityBonus:"å…µåŠ›åŠ æˆ",kokudakaBonus:"çŸ³é«˜åŠ æˆ",otherEffects:"å…¶ä»–æ•ˆæœ"})[u]||u;return e.jsxs("div",{className:"data-import",children:[e.jsx("h2",{children:"æ•°æ®å¯¼å…¥"}),e.jsx("div",{className:"import-type-selector",children:["territory","legion","faction","specialProduct"].map(u=>e.jsx("button",{className:`type-btn ${a===u?"active":""}`,onClick:()=>i(u),children:N(u)},u))}),t&&e.jsxs("div",{className:"template-info",children:[e.jsx("h3",{children:"å¯¼å…¥æ ¼å¼è¯´æ˜"}),e.jsx("p",{children:t.description}),e.jsxs("div",{className:"template-header",children:[e.jsx("strong",{children:"è¡¨å¤´ï¼š"}),t.template]})]}),e.jsxs("div",{className:"import-input-section",children:[e.jsx("label",{children:"ç²˜è´´Excelæ•°æ®ï¼ˆåˆ¶è¡¨ç¬¦åˆ†éš”ï¼‰ï¼š"}),e.jsx("textarea",{className:"import-textarea",value:c,onChange:u=>o(u.target.value),placeholder:`ä»Excelå¤åˆ¶æ•°æ®åç²˜è´´åˆ°æ­¤å¤„...

æç¤ºï¼šç›´æ¥ä»Excelé€‰ä¸­æ•°æ®åŒºåŸŸå¤åˆ¶ï¼Œç²˜è´´å³å¯ã€‚æ•°æ®ä¼šä»¥åˆ¶è¡¨ç¬¦åˆ†éš”ã€‚`})]}),e.jsxs("div",{className:"import-actions",children:[e.jsx("button",{className:"preview-btn",onClick:E,disabled:k||!c.trim(),children:"é¢„è§ˆæ•°æ®"}),e.jsx("button",{className:"import-btn",onClick:I,disabled:k||!c.trim(),children:"ç¡®è®¤å¯¼å…¥"}),e.jsxs("div",{className:"overwrite-option",children:[e.jsx("input",{type:"checkbox",id:"overwrite",checked:f,onChange:u=>l(u.target.checked)}),e.jsx("label",{htmlFor:"overwrite",children:"è¦†ç›–ç°æœ‰æ•°æ®"})]})]}),k&&e.jsxs("div",{className:"loading-overlay",children:[e.jsx("div",{className:"spinner"}),e.jsx("span",{children:"å¤„ç†ä¸­..."})]}),g&&e.jsx("div",{className:"import-messages",children:e.jsxs("div",{className:"error-list",children:[e.jsx("h4",{children:"é”™è¯¯"}),e.jsx("p",{children:g})]})}),h&&e.jsxs("div",{className:"preview-result",children:[e.jsx("h3",{children:"æ•°æ®é¢„è§ˆ"}),e.jsxs("div",{className:"preview-stats",children:[e.jsxs("span",{children:["è§£æè¡Œæ•°ï¼š",e.jsx("span",{className:"count",children:h.rowCount})]}),h.errors.length>0&&e.jsxs("span",{style:{color:"#c62828"},children:["é”™è¯¯ï¼š",e.jsx("span",{className:"count",children:h.errors.length})]}),h.warnings.length>0&&e.jsxs("span",{style:{color:"#f57f17"},children:["è­¦å‘Šï¼š",e.jsx("span",{className:"count",children:h.warnings.length})]})]}),D(),h.errors.length>0&&e.jsxs("div",{className:"error-list",style:{marginTop:"15px"},children:[e.jsx("h4",{children:"è§£æé”™è¯¯"}),e.jsx("ul",{children:h.errors.map((u,p)=>e.jsx("li",{children:u},p))})]}),h.warnings.length>0&&e.jsxs("div",{className:"warning-list",style:{marginTop:"15px"},children:[e.jsx("h4",{children:"è­¦å‘Š"}),e.jsx("ul",{children:h.warnings.map((u,p)=>e.jsx("li",{children:u},p))})]})]}),y&&e.jsxs("div",{className:`import-result ${y.errors.length===0?"success":y.imported>0?"partial":"error"}`,children:[e.jsx("h3",{children:y.errors.length===0?"å¯¼å…¥æˆåŠŸ":y.imported>0?"éƒ¨åˆ†å¯¼å…¥æˆåŠŸ":"å¯¼å…¥å¤±è´¥"}),e.jsxs("p",{children:["æˆåŠŸå¯¼å…¥ ",y.imported," æ¡æ•°æ®"]}),y.errors.length>0&&e.jsxs("div",{className:"error-list",style:{marginTop:"15px",textAlign:"left"},children:[e.jsx("h4",{children:"é”™è¯¯"}),e.jsx("ul",{children:y.errors.map((u,p)=>e.jsx("li",{children:u},p))})]}),y.warnings.length>0&&e.jsxs("div",{className:"warning-list",style:{marginTop:"15px",textAlign:"left"},children:[e.jsx("h4",{children:"è­¦å‘Š"}),e.jsx("ul",{children:y.warnings.map((u,p)=>e.jsx("li",{children:u},p))})]})]})]})}function Ia(){const[s,a]=n.useState([]),[r,t]=n.useState(!0),[d,c]=n.useState(null),[o,f]=n.useState(null),[l,k]=n.useState(""),[m,h]=n.useState("all"),[v,y]=n.useState([]);n.useEffect(()=>{g(),j()},[]);const j=async()=>{const N=await Le();N.success&&N.data&&y(N.data)},g=async()=>{t(!0),c(null);const N={};l&&(N.factionId=l),m==="true"&&(N.resolved=!0),m==="false"&&(N.resolved=!1);const D=await Ms(Object.keys(N).length>0?N:void 0);D.success&&D.data?a(D.data):c(D.error||"åŠ è½½å¤±è´¥"),t(!1)},C=async N=>{(await qs(N)).success&&(g(),(o==null?void 0:o.id)===N&&f({...o,resolved:!0}))},b=async N=>{if(!confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡é”™è¯¯æŠ¥å‘Šå—ï¼Ÿ"))return;(await Ks(N)).success&&(g(),(o==null?void 0:o.id)===N&&f(null))},i=()=>{g()},E=N=>new Date(N).toLocaleString("zh-CN"),I=N=>{const D=v.find(q=>q.id===N);return(D==null?void 0:D.name)||N};return e.jsxs("div",{className:"error-report-panel",children:[e.jsx("h2",{children:"é”™è¯¯æŠ¥å‘Šç®¡ç†"}),e.jsxs("div",{className:"error-report-filters",children:[e.jsxs("select",{value:l,onChange:N=>k(N.target.value),children:[e.jsx("option",{value:"",children:"æ‰€æœ‰åŠ¿åŠ›"}),v.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]}),e.jsxs("select",{value:m,onChange:N=>h(N.target.value),children:[e.jsx("option",{value:"all",children:"å…¨éƒ¨çŠ¶æ€"}),e.jsx("option",{value:"false",children:"æœªå¤„ç†"}),e.jsx("option",{value:"true",children:"å·²å¤„ç†"})]}),e.jsx("button",{onClick:i,children:"ç­›é€‰"})]}),r&&e.jsx("div",{className:"loading",children:"åŠ è½½ä¸­..."}),d&&e.jsx("div",{className:"error-message",children:d}),e.jsxs("div",{className:"error-report-content",children:[e.jsx("div",{className:"error-report-list",children:s.length===0?e.jsx("div",{className:"no-reports",children:"æš‚æ— é”™è¯¯æŠ¥å‘Š"}):s.map(N=>e.jsxs("div",{className:`error-report-item ${(o==null?void 0:o.id)===N.id?"selected":""} ${N.resolved?"resolved":""}`,onClick:()=>f(N),children:[e.jsxs("div",{className:"report-header",children:[e.jsx("span",{className:`report-type ${N.errorType}`,children:N.errorType==="manual"?"æ‰‹åŠ¨":"è‡ªåŠ¨"}),e.jsx("span",{className:`report-status ${N.resolved?"resolved":"pending"}`,children:N.resolved?"å·²å¤„ç†":"å¾…å¤„ç†"})]}),e.jsxs("div",{className:"report-info",children:[e.jsx("span",{className:"report-player",children:N.playerName}),e.jsx("span",{className:"report-faction",children:I(N.factionId)})]}),e.jsx("div",{className:"report-time",children:E(N.timestamp)}),N.errorMessage&&e.jsxs("div",{className:"report-message-preview",children:[N.errorMessage.substring(0,50),N.errorMessage.length>50?"...":""]})]},N.id))}),o&&e.jsxs("div",{className:"error-report-detail",children:[e.jsx("h3",{children:"æŠ¥å‘Šè¯¦æƒ…"}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"æŠ¥å‘Šç±»å‹ï¼š"}),e.jsx("span",{children:o.errorType==="manual"?"æ‰‹åŠ¨æŠ¥å‘Š":"è‡ªåŠ¨æŠ¥å‘Š"})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"çŠ¶æ€ï¼š"}),e.jsx("span",{className:o.resolved?"status-resolved":"status-pending",children:o.resolved?"å·²å¤„ç†":"å¾…å¤„ç†"})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"ç©å®¶ï¼š"}),e.jsx("span",{children:o.playerName})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"åŠ¿åŠ›ï¼š"}),e.jsx("span",{children:I(o.factionId)})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"æ—¶é—´ï¼š"}),e.jsx("span",{children:E(o.timestamp)})]}),o.errorMessage&&e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"é”™è¯¯æè¿°ï¼š"}),e.jsx("div",{className:"error-description",children:o.errorMessage})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("label",{children:"æœ€è¿‘æ“ä½œè®°å½•ï¼š"}),e.jsx("div",{className:"operations-list",children:o.recentOperations.length===0?e.jsx("div",{className:"no-operations",children:"æ— æ“ä½œè®°å½•"}):o.recentOperations.map((N,D)=>e.jsxs("div",{className:"operation-item",children:[e.jsx("div",{className:"operation-time",children:E(N.timestamp)}),e.jsx("div",{className:"operation-action",children:N.action}),e.jsx("div",{className:"operation-details",children:JSON.stringify(N.details,null,2)})]},N.id||D))})]}),e.jsxs("div",{className:"detail-actions",children:[!o.resolved&&e.jsx("button",{className:"btn-resolve",onClick:()=>C(o.id),children:"æ ‡è®°ä¸ºå·²å¤„ç†"}),e.jsx("button",{className:"btn-delete",onClick:()=>b(o.id),children:"åˆ é™¤"})]})]})]})]})}function La({onBack:s}){const[a,r]=n.useState("territories"),[t,d]=n.useState(0),c=[{key:"territories",label:"éƒ¡å›½ç®¡ç†"},{key:"factions-full",label:"åŠ¿åŠ›ç®¡ç†"},{key:"factions",label:"åŠ¿åŠ›ä»£ç "},{key:"legions",label:"å†›å›¢ä¸€è§ˆ"},{key:"products",label:"ç‰¹äº§é…ç½®"},{key:"progress",label:"æ¸¸æˆè¿›ç¨‹"},{key:"import",label:"æ•°æ®å¯¼å…¥"},{key:"errors",label:"é”™è¯¯æŠ¥å‘Š"}],o=()=>{d(f=>f+1)};return e.jsxs("div",{className:"admin-panel",children:[e.jsxs("header",{className:"admin-header",children:[e.jsx("button",{className:"back-btn",onClick:s,children:"â† è¿”å›ä»ªè¡¨ç›˜"}),e.jsx("h1",{children:"ç®¡ç†å‘˜æ•°æ®ç®¡ç†"})]}),e.jsx("nav",{className:"admin-tabs",children:c.map(f=>e.jsx("button",{className:`tab-btn ${a===f.key?"active":""}`,onClick:()=>r(f.key),children:f.label},f.key))}),e.jsxs("main",{className:"admin-content",children:[a==="territories"&&e.jsx(Na,{},`territories-${t}`),a==="factions-full"&&e.jsx(ya,{},`factions-full-${t}`),a==="factions"&&e.jsx(ga,{},`factions-${t}`),a==="legions"&&e.jsx(Ca,{},`legions-${t}`),a==="products"&&e.jsx(ka,{},`products-${t}`),a==="progress"&&e.jsx(Sa,{}),a==="import"&&e.jsx(wa,{onImportComplete:o}),a==="errors"&&e.jsx(Ia,{})]})]})}function Pa(){const[s,a]=n.useState(null),[r,t]=n.useState(!0),[d,c]=n.useState(!1),[o,f]=n.useState(null);n.useEffect(()=>{l()},[]);const l=async()=>{var y;const h=Ys();if(h.code)try{const j=await Re(h.code);if(j.success){we(),a({type:j.userType,factionId:j.factionId}),t(!1);return}else f(j.error||"é“¾æ¥ä¸­çš„ç™»å½•ä»£ç æ— æ•ˆ"),we()}catch{f("é“¾æ¥ç™»å½•å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¾“å…¥ä»£ç "),we()}if(!Oe()){t(!1);return}try{const j=await He();j.success&&((y=j.data)!=null&&y.user)?a(j.data.user):me(null)}catch{me(null)}finally{t(!1)}},k=h=>{console.log("handleLoginSuccess called with:",h),console.log("user.type:",h.type,"user.factionId:",h.factionId),a(h),f(null)},m=()=>{a(null),c(!1)};return r?e.jsxs("div",{className:"app-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"åŠ è½½ä¸­..."})]}):s?(console.log("Rendering with user:",s),console.log("Condition check: user.type === admin:",s.type==="admin","showAdminPanel:",d,"!user.factionId:",!s.factionId),s.type==="admin"&&(d||!s.factionId)?e.jsx(La,{user:s,onBack:()=>{s.factionId?c(!1):m()}}):e.jsx(pa,{user:s,onLogout:m,onOpenAdminPanel:s.type==="admin"?()=>c(!0):void 0})):e.jsx(Xs,{onLoginSuccess:k,initialError:o})}Ie.createRoot(document.getElementById("root")).render(e.jsx(qe.StrictMode,{children:e.jsx(Pa,{})}));
